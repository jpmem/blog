---
title: クライアントがコンテンツのダウンロードを行う際の帯域の制限
date: 2025-06-19
tags:
  - MECM
---
# クライアントがコンテンツのダウンロードを行う際の帯域の制限
みなさま、こんにちは。Configuration Manager サポート チームです。

今回は、Configuration Manager (ConfigMgr) クライアントがコンテンツのダウンロードを行う際に使用するネットワーク帯域の制限についてご案内します。基本的に ConfigMgr クライアントは BITS（バックグラウンド インテリジェント転送サービス）を用いてコンテンツをダウンロードしますが、このとき使用されるネットワーク帯域はクライアント設定で制限できます。そのため、帯域が限られている環境では BITS の帯域を制限されているお客様も多いと思います。しかし、設定後に予期せぬ結果とならないよう、いくつか押さえておくべきポイントがあります。


## フォアグラウンドのダウンロードは帯域を制限できません
ConfigMgr クライアントが生成する BITS ジョブには、フォアグラウンドとバックグラウンドの 2 つの転送モードがございます。このうち、帯域を制限できるのは、バックグラウンド 転送モードのみであることに注意が必要です。ConfigMgr がコンテンツを配布するシナリオごとの、転送モードを表 1 に示します。

<table align="center">
  <caption style="text-align:center; font-weight:bold;">表 1: BITS の転送モード</caption>
  <thead>
    <tr>
      <th>コンテンツの種類</th>
      <th>ソフトウェア センターからインストールする場合</th>
      <th>自動でインストールする場合(必須の展開)
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>アプリケーション</td>
      <td>フォアグラウンド</td>
      <td>バックグラウンド</td>
    </tr>
    <tr>
      <td>パッケージ</td>
      <td>バックグラウンド</td>
      <td>バックグラウンド</td>
    </tr>
    <tr>
      <td>ソフトウェア更新プログラム</td>
      <td>フォアグラウンド</td>
      <td>バックグラウンド</td>
  </tbody>
</table>

表 1 からわかる通り、ソフトウェア更新プログラムやアプリケーションは、ソフトウェア センターを使用し [インストール] ボタンをクリックした場合、その転送はフォアグラウンド 転送モードになるため、帯域制限の設定は無視されます。一方、パッケージの場合はソフトウェア センターの利用有無を問わず、常にバックグラウンド 転送モードになるため、帯域制限の設定は有効です。

したがって、コンテンツの種類を問わずダウンロード時の帯域を制限したい場合は、ソフトウェア センターによるインストールを避け、[利用可能] ではなく [必須] で展開する必要があります。ただし、必須展開でも「インストールの期限」に到達した時点でダウンロードやインストールが未完了の場合は、ソフトウェア センターから [インストール] ボタンをクリックすることが可能です。この状態で [インストール] ボタンをクリックしたとき、コンテンツのダウンロードが未完了であればフォアグラウンド 転送モードでダウンロードが発生します。


## コンテンツのダウンロード時は BITS を使用します
上記の動作をご理解いただいていたとしても、「帯域が制限される場合のみ BITS を使用し、そうでない場合は BITS 以外が使われる」と誤解されることがありますが、これは正しくありません。 ConfigMgr のコンテンツ配布は一部の例外を除き、通常 BITS を利用します。帯域が制限されるか否かは、あくまで転送モード(フォアグラウンドかバックグラウンドか)の違いということです。

なお、UUP (Unified Update Platform) 形式の更新プログラムのダウンロード時には、標準設定の場合、OS の配信の最適化 (DO) エージェントも関与しますが、その場合も DO エージェント が ConfigMgr クライアントがローカルに生成したサーバー プロセス (localhost:8005) にコンテンツを要求し、このサーバーが代理で外部から BITS でコンテンツのダウンロードを行います。先にご案内した一部の例外として、DO の機能だけを使うよう設定も構成できるため、厳密にはすべてが BITS というわけではありませんが、ConfigMgr クライアントがコンテンツのダウンロードを行う際は基本的に BITS が使用されます。


## 時間帯以外の条件に応じて帯域を制限することは不可です
BITS は ConfigMgr の専用機能ではなく、OS の汎用的なサービスであり、すべてのアプリケーションが共有しています。そのため、帯域制限の設定を行う場合、その OS 上ですべての BITS ジョブが対象となります。クライアント設定で帯域を制限すると、実際には「BITS バックグラウンド転送の最大ネットワーク帯域幅を制限する」設定がローカル グループ ポリシーとして適用されます。設定可能な条件は「特定の時間帯」と「それ以外の時間帯」のみで、アプリケーションごとの制限やインターネット接続時のみ帯域制限を行う、といった細かい条件での制限はできません。

ご参考：
https://learn.microsoft.com/ja-jp/intune/configmgr/core/clients/deploy/about-client-settings#limit-the-maximum-network-bandwidth-for-bits-background-transfers

なお、クライアント設定ではなく、Active Directory グループ ポリシーで「BITS バックグラウンド転送の最大ネットワーク帯域幅を制限する」を設定した場合は、クライアント設定と競合が発生します。そのため ConfigMgr クライアントが稼働する環境では、クライアント設定のみで制限することを推奨します。

