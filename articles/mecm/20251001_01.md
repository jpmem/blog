---
title: Windows 10 ESU を Configuration Manager 経由で適用する
date: 2025-10-01
tags:
  - MECM
---

# Windows 10 ESU を Configuration Manager 経由で適用する

みなさま、こんにちは。Configuration Manager サポート チームです。

今回は、Windows 10 の Extended Security Updates (ESU, 拡張セキュリティ更新プログラム) について取り上げたいと思います。
既にご存じの方も多いかと思いますが、Windows 10 のサポートは 2025 年 10 月 14 日で終了いたします。

しかし、組織の中ではまだ Windows 11 に移行できず、Windows 10 を利用し続ける必要があるシナリオもあると思います。
その場合、追加コストを支払い、ESU を適用することで引き続きソフトウェア更新プログラム (セキュリティ パッチ) を受け取ることができます。

ESU を適用するには、対象環境に MAK (Multiple Activation Key) キーを適用してアクティベーションする必要があります。
サポート終了後に、提供されるソフトウェア更新プログラムは、Microsoft Update Catalog サイトからどなたでもダウンロードできますが、ESU の MAK キーを適用していないとソフトウェア更新プログラムの適用に失敗しますので、注意が必要です。

本記事では、Configuration Manager 経由で、一斉に MAK キーの認証を行う手順についてご紹介いたします。


# ESU MAK キーの入手方法について
最初に、ESU MAK キーの入手方法と、ESU プログラムの　Acticvation ID の確認が必要となりますので、以下の公開情報を参考に、事前に MAK キーの入手と、指定する Acticvation ID を確定くださいますと幸いです。

拡張セキュリティ Updates (ESU) を有効にする  
https://learn.microsoft.com/ja-jp/windows/whats-new/enable-extended-security-updates#get-the-product-keys-for-activating-extended-security-update-esu-licenses

Windows 10 ESU に関するよくあるお問い合わせ
https://jpwinsup.github.io/blog/2025/09/29/Activation/Windows10-ESU-QA/


MAK キーと、Activation ID の情報が入手できましたら、準備完了です。
次の手順を参考に、ESU MAK キーの適用と、Activation ID の適用を行います。

# 手動で適用する方法

手動で適用する場合は、以下のようなコマンド ラインを実行します。

サンプル：
```command
cscript %WinDir%\system32\slmgr.vbs /ipk <MAK キーの入力>
cscript %WinDir%\system32\slmgr.vbs /ato <Activation ID の入力>
```

# Configuration Manager 経由で適用する方法

## 目次  
**事前作業**  
**A. パッケージとプログラムの作成**  
**B. パッケージの展開**  
**C. インストールの実行**

## 事前作業
以下の内容を参考に、拡張子 .bat のファイルを作成します。(ここでは、esu.bat と仮定します)
```command
@echo off
cscript %WinDir%\system32\slmgr.vbs /ipk <MAK キーの入力>
cscript %WinDir%\system32\slmgr.vbs /ato <Activation ID の入力>
```

## A. パッケージとプログラムの作成

1. プライマリ サイト サーバー上で、事前に共有フォルダーを作成します。共有ファルダ―は新規で作成し、このパッケージ専用として扱います。
例：**"\\\PriSite\ESUpackage\"**  

2. esu.bat のファイルを、共有フォルダーにコピーします。(手順 5. で使います)
3. Configuration Manager コンソールを起動し、[ソフトウェア ライブラリ] > [アプリケーション管理] > [パッケージ] を右クリックし、[パッケージの作成] をクリックします。
4. [パッケージとプログラムの作成ウィザード] の [パッケージ] より、任意の名前を入力し、[このパッケージにソース ファイルを含める] にチェックを入れ、[参照] をクリックします。
5. [ソース フォルダー] の設定より、さらに [参照] をクリックし、共有フォルダーのパスを入力し、[OK] をクリックします。
6. [パッケージ] より、共有フォルダーのパスが登録されていることを確認し、[次へ] をクリックします。
7. [プログラムの種類] より、[標準プログラム] が選択されている状態のまま、[次へ] をクリックします。
8. [標準プログラム] より、以下の項目を設定し、[参照] をクリックします。

    - 名前：任意の名前   
    - コマンド ライン：  

    ```command
    %windir%\sysnative\cmd.exe /c esu.bat
    ```
    - プログラムの実行条件：ユーザーのログオン状態に関係なし  
    - 実行モード：管理者権限で実行する（自動で選択されます）  

9. [要件] より、必要に応じて設定を行い、[次へ] をクリックします。
10. [概要] より、設定内容に誤りがないことを確認し、[次へ] をクリックします。
11. [完了] より、正常に完了したことを確認し、[閉じる] をクリックします。
12. [パッケージ] の [ナビゲーション ペイン] より、作成したパッケージが登録されていることを確認します。

## B. パッケージの展開

1. Configuration Manager コンソールより、[ソフトウェア ライブラリ] > [アプリケーション管理] > [パッケージ] を開きます。
2. 先ほど作成したパッケージを右クリックし、[展開] をクリックし、[ソフトウェアの展開ウィザード] を開きます。
3. [全般] にて [コレクション] - [参照] をクリックし、展開先コレクションを指定し [OK] をクリックし、[次へ] をクリックします。
4. [コンテンツ] にて、[追加] をクリックし、配布ポイントを指定し、[次へ] をクリックします。
5. [展開設定] にて "目的" を [利用可能] とし、[次へ] をクリックします。
([必須] 場合にはサイレント実行されるため、テストする際には、[利用可能] とし、テスト展開いただくことをお勧めいたします。)

6. [スケジュール] にて必要に応じたスケジュールを指定し、[次へ] をクリックします。
7. [ユーザー側の表示と操作] にて既定のまま [次へ] をクリックします。
8. [配布ポイント] にて、配布ポイントを指定して、[次へ] をクリックします。
9. [概要] にて [次へ] をクリックします。
10. ウィザードが完了したことを確認し、[閉じる] をクリックします。
11. 展開後、[パッケージ] の [ナビゲーション ペイン] より、展開したパッケージのコンテンツ ステータスが緑色の円グラフになることを確認します。
※画面をリフレッシュして、円グラフの更新状況を確認ください。  

## C. 展開結果の確認

1. クライアントにて、コントロール パネル を開き、[Configuration Manager] を実行します。
2. [Configuration Manager のプロパティ画面] が開きます。
3. [操作] タブにて [コンピューター ポリシーの取得および評価サイクル] を選択し、[直ちに実行] をクリックします。
4. ソフトウェア センターを開き、該当のパッケージが表示されましたら、[インストール] を実行します。
