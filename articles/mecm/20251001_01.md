---
title: Windows 10 ESU を Configuration Manager 経由で適用する
date: 2025-10-01
tags:
  - MECM
---

# Windows 10 ESU を Configuration Manager 経由で適用する

みなさま、こんにちは。Configuration Manager サポート チームです。

Windows 10 のサポートは 2025 年 10 月 14 日で終了いたします。

Configuration Manager 環境においては、Windows 10 自体の管理に関するサポート全般についても、サポート終了となりますが、一部例外として、Configuration Manager バージョンが最新であり、かつ Windows 10 ESU を適用している環境に対しては、セキュリティ更新プログラムの展開が可能となっております。

Configuration Manager でサポートされる、クライアントとデバイスの OS のバージョン - 拡張セキュリティ更新プログラムと Configuration Manager  
https://learn.microsoft.com/ja-jp/intune/configmgr/core/plan-design/configs/supported-operating-systems-for-clients-and-devices#bkmk_ESU

これは Windows 11 へのアップグレードを控えているデバイスや、更新プログラムのみ適用をし続けたいといったニーズに沿うものとなります。
また、Windows 10 ESU を適用していないデバイスにおいては、サポート終了以降にリリースされるセキュリティ更新プログラムの適用に失敗しますので、更新プログラムの展開を受け続けるためには、事前に Windows 10 ESU を適用することが必要となります。

そのため、今回は Configuration Manager を使用して Windows 10 ESU を適用する手順に加え、
ESU の適用状況を確認するためのハードウェア インベントリの拡張手順と、リソース エクスプローラーを使用した確認方法についても併せてご紹介いたします。

# ESU MAK キーの入手方法について
今回ご紹介する手順は、ライセンス認証をインターネット経由で行う前提の環境下を想定しておりますので、通信要件については以下の記事をご参考くださいますと幸いです。

Windows 10 ESU に関するよくあるお問い合わせ
https://jpwinsup.github.io/blog/2025/09/29/Activation/Windows10-ESU-QA/  
[MAK キーによる Windows 10 ESU を適用したいですが、どうすればよいですか？] の項

次に、ESU MAK キーの入手と、ESU プログラムの Activation ID の確認が必要となりますので、上記の記事を参考に、事前に MAK キーの入手と、指定する Activation ID を確定ください。

# 手動で適用する方法

手動で適用する場合は、管理者権限でコマンドプロンプトを起動し、以下の形式のコマンドを実行します。

サンプル：
```command
cscript %WinDir%\system32\slmgr.vbs /ipk <MAK キーの入力>
cscript %WinDir%\system32\slmgr.vbs /ato <Activation ID の入力>
```

# Configuration Manager 経由で適用する方法

## 目次  
**A. 事前作業**  
**B. パッケージとプログラムの作成**  
**C. パッケージの展開**  
**D. インストールの実行**

## A. 事前作業
以下の内容を参考に、拡張子 .bat のファイルを作成します。(ここでは、esu.bat と仮定します)
```command
@echo off
cscript %WinDir%\system32\slmgr.vbs /ipk <MAK キーの入力>
cscript %WinDir%\system32\slmgr.vbs /ato <Activation ID の入力>
```

## B. パッケージとプログラムの作成

1. プライマリ サイト サーバー上で、事前に共有フォルダーを作成します。共有ファルダ―は新規で作成し、このパッケージ専用として扱います。
例：**"\\\PriSite\ESUpackage\"**  

2. esu.bat のファイルを、共有フォルダーにコピーします。(手順 5. で使います)
3. Configuration Manager コンソールを起動し、[ソフトウェア ライブラリ] > [アプリケーション管理] > [パッケージ] を右クリックし、[パッケージの作成] をクリックします。
4. [パッケージとプログラムの作成ウィザード] の [パッケージ] より、任意の名前を入力し、[このパッケージにソース ファイルを含める] にチェックを入れ、[参照] をクリックします。
5. [ソース フォルダー] の設定より、さらに [参照] をクリックし、共有フォルダーのパスを入力し、[OK] をクリックします。
6. [パッケージ] より、共有フォルダーのパスが登録されていることを確認し、[次へ] をクリックします。
7. [プログラムの種類] より、[標準プログラム] が選択されている状態のまま、[次へ] をクリックします。
8. [標準プログラム] より、以下の項目を設定し、[参照] をクリックします。

    - 名前：任意の名前   
    - コマンド ライン：  

    ```command
    %windir%\sysnative\cmd.exe /c esu.bat
    ```
    - プログラムの実行条件：ユーザーのログオン状態に関係なし  
    - 実行モード：管理者権限で実行する（自動で選択されます）  

9. [要件] より、必要に応じて設定を行い、[次へ] をクリックします。
10. [概要] より、設定内容に誤りがないことを確認し、[次へ] をクリックします。
11. [完了] より、正常に完了したことを確認し、[閉じる] をクリックします。
12. [パッケージ] の [ナビゲーション ペイン] より、作成したパッケージが登録されていることを確認します。

## C. パッケージの展開

1. Configuration Manager コンソールより、[ソフトウェア ライブラリ] > [アプリケーション管理] > [パッケージ] を開きます。
2. 先ほど作成したパッケージを右クリックし、[展開] をクリックし、[ソフトウェアの展開ウィザード] を開きます。
3. [全般] にて [コレクション] - [参照] をクリックし、展開先コレクションを指定し [OK] をクリックし、[次へ] をクリックします。
4. [コンテンツ] にて、[追加] をクリックし、配布ポイントを指定し、[次へ] をクリックします。
5. [展開設定] にて "目的" を [利用可能] とし、[次へ] をクリックします。
([必須] 場合にはサイレント実行されるため、テストする際には、[利用可能] とし、テスト展開いただくことをお勧めいたします。)

6. [スケジュール] にて必要に応じたスケジュールを指定し、[次へ] をクリックします。
7. [ユーザー側の表示と操作] にて既定のまま [次へ] をクリックします。
8. [配布ポイント] にて、配布ポイントを指定して、[次へ] をクリックします。
9. [概要] にて [次へ] をクリックします。
10. ウィザードが完了したことを確認し、[閉じる] をクリックします。
11. 展開後、[パッケージ] の [ナビゲーション ペイン] より、展開したパッケージのコンテンツ ステータスが緑色の円グラフになることを確認します。
※画面をリフレッシュして、円グラフの更新状況を確認ください。  

## D. インストールの実行

1. クライアントにて、コントロール パネル を開き、[Configuration Manager] を実行します。
2. [Configuration Manager のプロパティ画面] が開きます。
3. [操作] タブにて [コンピューター ポリシーの取得および評価サイクル] を選択し、[直ちに実行] をクリックします。
4. ソフトウェア センターを開き、該当のパッケージが表示されましたら、[インストール] を実行します。
<br><br>

# Configuration Manager コンソールで ESU 適用状況を確認する

Configuration Manager コンソール上より、ESU ライセンスの適用状況を確認する手順を紹介いたします。

## 目次
A. ハードウェア インベントリのクラスを追加する  
B. リソース エクスプローラーより確認する

## A. ハードウェア インベントリのクラスを追加する

1. Configuration Manager コンソールより、[管理\概要\クライアント設定] を選択します。
2. クライアント設定より、[既定のクライアント設定] もしくは カスタムで作成されているクライアント設定を右クリックし、[プロパティ] を開きます。
3. [ハードウェア インベントリ] 項目の、"ハードウェア インベントリ クラス" の [クラスの設定] ボタンをクリックします。
4. 検索バーに、"SoftwareLicensingProduct" と入力して検索し、検索結果より、「ソフトウェア ライセンス製品 – 資産インテリジェンス (SoftwareLicensingProduct)」 にチェックを付けます。
5. [OK] をクリックし、クライアント設定を閉じます。
6. クライアント側で即時で反映を促す場合には、コントロール パネルを開き、表示方法を "小さいアイコン" に変更し、[Configuration Manager] を開き、[操作] タブより、以下のサイクルを選択し、[直ちに実行] をそれぞれクリックします。  
・コンピューター ポリシーの取得および評価サイクル  
・ハードウェア インベントリ サイクル  

## B. リソース エクスプローラーより確認する

1. Configuration Manager コンソールにて、[資産とコンプライアンス\概要\デバイス] より、デバイスを右クリックし、[開始]-[リソースエクスプローラー] をクリックします。

2. [ハードウェア]-[ソフトウェア ライセンス製品] を選択し、右側のフィルター内に、ESU の Activation ID を入力し、Enter をクリックします。

```
・ESU Program Activation ID
Win10 ESU Year1 f520e45e-7413-4a34-a497-d2765967d094
Win10 ESU Year2 1043add5-23b1-4afb-9a0f-64343c8f3f8d
Win10 ESU Year3 83d49986-add3-41d7-ba33-87c7bfb5c0fb
```

3. 結果として、表示された項目の、[ライセンスのステータス] 列が 1 となっていれば、ライセンス済みと判断いただけます。

※ Win10 ESU Year1 の Activation ID を基に検索した例

   ![ResourceExplorer](./20251001_01/20251001_01_01.png)

