<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Microsoft Configuration Manager Support Team Blog</title>
  
  <subtitle>日本マイクロソフト Microsoft Configuration Manager / Windows 365 / WSUS サポート チームのブログです。</subtitle>
  <link href="https://jpmem.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpmem.github.io/blog/"/>
  <updated>2023-03-02T03:37:32.641Z</updated>
  <id>https://jpmem.github.io/blog/</id>
  
  <author>
    <name>Japan Microsoft Configuration Manager Support Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>WSUS のトラブルシューティングに役立つリンク集</title>
    <link href="https://jpmem.github.io/blog/wsus/2023-02-28_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2023-02-28_01/</id>
    <published>2023-02-27T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.641Z</updated>
    
    <content type="html"><![CDATA[<p>皆さま こんにちは。 Configuration Manager サポートチームです。<br>こちらは WSUS のトラブルシューティングに役立つリンク集です。<br>WSUS を利用中にお困りの際、ぜひお役立てください！</p><h3 id="更新プログラムのダウンロード時の失敗"><a href="#更新プログラムのダウンロード時の失敗" class="headerlink" title="更新プログラムのダウンロード時の失敗"></a>更新プログラムのダウンロード時の失敗</h3><p>こちらは WSUS サーバーで、更新プログラムをダウンロードする時に失敗する際に参考になるブログです。<br>対処方法をご紹介しておりますので、詳しくはブログをご参考にしてくださいませ。  </p><p>Title: WSUS サーバーで、一部のダウンロードが失敗する ( File cert verification failure )<br>URL: <a href="https://jpmem.github.io/blog/wsus/2013-02-18_01/">https://jpmem.github.io/blog/wsus/2013-02-18_01/</a>  </p><p>Title: Windows 10 および Windows Server 2016 の環境で、更新プログラムのダウンロードが途中から進まなくなる問題について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2016-10-28_01/">https://jpmem.github.io/blog/wsus/2016-10-28_01/</a>  </p><p>Title: WSUS サーバーのダウンロード障害について – BITS と Range ヘッダー<br>URL: <a href="https://jpmem.github.io/blog/wsus/2022-06-30_01/">https://jpmem.github.io/blog/wsus/2022-06-30_01/</a>  </p><p>Title: Windows Server 2016 以降の WSUS で更新プログラムのダウンロードが 0% で進まない場合のチェックポイント<br>URL: <a href="https://jpmem.github.io/blog/wsus/2021-03-18_01/">https://jpmem.github.io/blog/wsus/2021-03-18_01/</a>  </p><p>Title: クライアントの更新プログラムのダウンロードが 0 %で進まない場合のチェックポイント ( WSUS )<br>URL: <a href="https://jpmem.github.io/blog/wsus/2022-03-25_01/">https://jpmem.github.io/blog/wsus/2022-03-25_01/</a>  </p><h3 id="更新プログラムの承認・拒否・インポート・インストール時の失敗"><a href="#更新プログラムの承認・拒否・インポート・インストール時の失敗" class="headerlink" title="更新プログラムの承認・拒否・インポート・インストール時の失敗"></a>更新プログラムの承認・拒否・インポート・インストール時の失敗</h3><p>こちらは WSUS サーバーで、更新プログラムを承認・拒否・インポート・インストールする時に失敗する際に参考になるブログです。<br>対処方法をご紹介しておりますので、詳しくはブログをご参考にしてくださいませ。  </p><p>Title: WSUS で予期しない更新プログラムを展開してしまったときの対応方法<br>URL: <a href="https://jpmem.github.io/blog/wsus/2016-10-07_01/">https://jpmem.github.io/blog/wsus/2016-10-07_01/</a>  </p><p>Title: WSUS 自動承認規則が反映されない事象について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2014-09-08_01/">https://jpmem.github.io/blog/wsus/2014-09-08_01/</a>  </p><p>Title: Windows Server 2016 の WSUS で更新プログラムのインポート時に互換性の問題が発生する事象<br>URL: <a href="https://jpmem.github.io/blog/wsus/2018-04-11_01/">https://jpmem.github.io/blog/wsus/2018-04-11_01/</a>  </p><p>Title: Microsoft Update カタログから更新プログラムの手動インポートに失敗する事象について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2020-08-24_01/">https://jpmem.github.io/blog/wsus/2020-08-24_01/</a>  </p><p>Title: WSUS 上に配信が必要な更新プログラムが同期されてこない！と思ったら<br>URL: <a href="https://jpmem.github.io/blog/wsus/2018-07-12_01/">https://jpmem.github.io/blog/wsus/2018-07-12_01/</a>  </p><p>Title: レプリカ WSUS サーバーの同期がタイムアウトで失敗する<br>URL: <a href="https://jpmem.github.io/blog/wsus/2019-04-09_01/">https://jpmem.github.io/blog/wsus/2019-04-09_01/</a>  </p><p>Title: 「3 – 自動ダウンロードとインストールを通知」 を選択していても、機能更新プログラムが自動インストールされてしまう問題<br>URL: <a href="https://jpmem.github.io/blog/wsus/2019-07-29_01/">https://jpmem.github.io/blog/wsus/2019-07-29_01/</a>  </p><p>Title: 「削除の承認」が Windows 10 2004 以降 / Windows 11 のクライアントに反映されない事象について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2022-06-08_01/">https://jpmem.github.io/blog/wsus/2022-06-08_01/</a>  </p><h3 id="WSUS-のインストール時の失敗"><a href="#WSUS-のインストール時の失敗" class="headerlink" title="WSUS のインストール時の失敗"></a>WSUS のインストール時の失敗</h3><p>こちらは WSUS サーバーをする時に失敗する際に参考になるブログです。<br>対処方法をご紹介しておりますので、詳しくはブログをご参考にしてくださいませ。  </p><p>Title: Windows Server 2012 にて WSUS のインストールに失敗する事象について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2014-04-02_02/">https://jpmem.github.io/blog/wsus/2014-04-02_02/</a>  </p><h3 id="WSUS-の運用時の失敗"><a href="#WSUS-の運用時の失敗" class="headerlink" title="WSUS の運用時の失敗"></a>WSUS の運用時の失敗</h3><p>こちらは WSUS サーバーを運用する時に失敗する際（接続、負荷など）に参考になるブログです。<br>対処方法をご紹介しておりますので、詳しくはブログをご参考にしてくださいませ。  </p><p>Title: クリーンアップ ウィザードにより IIS のプロセスがクラッシュする<br>URL: <a href="https://jpmem.github.io/blog/wsus/2015-06-03_01/">https://jpmem.github.io/blog/wsus/2015-06-03_01/</a>  </p><p>Title: WSUS クリーンアップ ウィザードにてタイムアウトが発生する<br>URL: <a href="https://jpmem.github.io/blog/wsus/2018-02-05_01/">https://jpmem.github.io/blog/wsus/2018-02-05_01/</a>  </p><p>Title: 稀に WsusService.exe が意図せず停止する事象について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2018-10-22_01/">https://jpmem.github.io/blog/wsus/2018-10-22_01/</a>  </p><p>Title: Windows 10 / Windows Server 2016 を管理している環境で WSUS サーバーの負荷が高騰する<br>URL: <a href="https://jpmem.github.io/blog/wsus/2019_04-04_01/">https://jpmem.github.io/blog/wsus/2019_04-04_01/</a>  </p><p>Title: SUSDB.mdf が肥大化したときの対処方法について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2020-03-27_01/">https://jpmem.github.io/blog/wsus/2020-03-27_01/</a>  </p><p>Title: WSUS (Windows Server 2012/Windows Server 2012 R2) の同期処理が失敗する事象について<br>URL: <a href="https://jpmem.github.io/blog/wsus/2020-07-28_01/">https://jpmem.github.io/blog/wsus/2020-07-28_01/</a>  </p><p>Title: Windows Server 2012 / 2012 R2 の WSUS へロールアップ を適用するとクライアントからの接続が失敗する事象について<br>URL: <a href="https://jpmem.github.io/blog/mecm/20200729_01/">https://jpmem.github.io/blog/mecm/20200729_01/</a>  </p><p>Title: WSUS でクライアントが正常に認識されない SusClientID の重複とは<br>URL: <a href="https://jpmem.github.io/blog/wsus/2022-05-18_01/">https://jpmem.github.io/blog/wsus/2022-05-18_01/</a>  </p><h3 id="WSUS-のコンソールに関する失敗"><a href="#WSUS-のコンソールに関する失敗" class="headerlink" title="WSUS のコンソールに関する失敗"></a>WSUS のコンソールに関する失敗</h3><p>こちらは WSUS コンソールに関する失敗に参考になるブログです。<br>対処方法をご紹介しておりますので、詳しくはブログをご参考にしてくださいませ。  </p><p>Title: 「WSUS 管理コンソールにつながらない！」を解消するための 7 つのワザ<br>URL: <a href="https://jpmem.github.io/blog/wsus/2019-03-28_01/">https://jpmem.github.io/blog/wsus/2019-03-28_01/</a>  </p><p>Title: WSUS コンソールが全く開かなくなってしまった！ WsusPool の停止とは<br>URL: <a href="https://jpmem.github.io/blog/wsus/2022-05-23_01/">https://jpmem.github.io/blog/wsus/2022-05-23_01/</a>  </p><p>Title: Window Server 2022 にて WSUS コンソールの言語表示が日本語にならない<br>URL: <a href="https://jpmem.github.io/blog/wsus/2022-10-07_01/">https://jpmem.github.io/blog/wsus/2022-10-07_01/</a>  </p><h3 id="その他"><a href="#その他" class="headerlink" title="その他"></a>その他</h3><p>こちらは ReportingEvents.log の見方を紹介するブログです。<br>このログ ファイル自体は以前の OS から存在していましたが、特に Windows 10 や Windows Server 2016 では Get-WindowsUpdateLog を実行しないと WindowsUpdate.log が参照出来なくなったので、検証の際やトラブル シューティングの際にリアルタイムにログを確認する場合には、こちらのログを利用することをお勧めしております。  </p><p>Title: ReportingEvents.log の見方<br>URL: <a href="https://jpmem.github.io/blog/wsus/2018-02-02_01/">https://jpmem.github.io/blog/wsus/2018-02-02_01/</a>  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;皆さま こんにちは。 Configuration Manager サポートチームです。&lt;br&gt;こちらは WSUS のトラブルシューティングに役立つリンク集です。&lt;br&gt;WSUS を利用中にお困りの際、ぜひお役立てください！&lt;/p&gt;
&lt;h3 id=&quot;更新プログラムのダウンロー</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
  </entry>
  
  <entry>
    <title>Configuration Manager クライアントの OS が意図せずにアップグレードしてしまった際の対処策について</title>
    <link href="https://jpmem.github.io/blog/mecm/20230220_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20230220_01/</id>
    <published>2023-02-19T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.513Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チーム 山田 です。</p><p>本日は、Configuration Manager 環境にてクライアントの OS が意図せずアップグレードしてしまった際の要因と対処策についてご紹介いたします。</p><p>想定される要因として以下 2 つが挙げられますので、それぞれの場合について記載させていただきます。</p><ol><li>[Microsoft Update の更新プログラムをオンラインで確認する] ボタンをクリックした。</li><li>[イントラネットの Microsoft 更新サービスの場所を指定する] ポリシーが “未構成” となっている。</li></ol><h3 id="1-Microsoft-Update-の更新プログラムをオンラインで確認する-ボタンをクリックした。"><a href="#1-Microsoft-Update-の更新プログラムをオンラインで確認する-ボタンをクリックした。" class="headerlink" title="1. [Microsoft Update の更新プログラムをオンラインで確認する] ボタンをクリックした。"></a>1. [Microsoft Update の更新プログラムをオンラインで確認する] ボタンをクリックした。</h3><h4 id="要因"><a href="#要因" class="headerlink" title="要因"></a>要因</h4><p>ソフトウェア更新ポイントが構成されている Configuration Manager 環境のクライアントであれば、クライアント端末より [設定] - [Windows Update] と辿ると以下のボタンが表示されています。</p><p><img src="/blog/mecm/20230220_01/2023-02-20-11-08-38.png"></p><p>上記のボタンを押すと構成されている WSUS サーバーではなく、Microsoft Update に対して更新プログラムをチェックしに行くため、その時点でクライアントがインストールできる最新の機能更新プログラムや品質更新プログラムをダウンロード、インストールしてしまいます。<br>そのため、結果的に意図していない OS のアップグレードが行われます。  </p><h4 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h4><p>以下 3 つのうち、どれかのポリシーを “有効” とすると、ユーザー側で [Microsoft Update の更新プログラムをオンラインで確認する] ボタンがクリックできなくなります。  </p><ol><li>[コンピューターの構成] - [管理用テンプレート] - [Windows Update] - [Windows Update のすべての機能へのアクセスを削除する]<br>※ [更新プログラムのチェック] ボタンもクリックできなくなります。</li><li>[コンピューターの構成] - [管理用テンプレート] - [Windows Update] - [インターネット上の Windows Update に接続しない]  </li><li>[コンピューターの構成] - [管理用テンプレート] - [システム] - [インターネット通信の管理] - [インターネット通信の設定]- [Windows Update のすべての機能へのアクセスをオフにする]  </li></ol><p>上記のうち [インターネット上の Windows Update に接続しない] ポリシーはインターネットから更新プログラムを取得することを禁止しますが、Microsoft ストア アプリの更新もブロックされます。<br>そのため、インターネットから更新プログラムを取得することは禁止したいが、ストア アプリの更新は行いたい場合、[Windows Update のすべての機能へのアクセスをオフにする] ポリシーを有効にしてください。  </p><h3 id="2-イントラネットの-Microsoft-更新サービスの場所を指定する-ポリシーが-“未構成”-となっている。"><a href="#2-イントラネットの-Microsoft-更新サービスの場所を指定する-ポリシーが-“未構成”-となっている。" class="headerlink" title="2. [イントラネットの Microsoft 更新サービスの場所を指定する] ポリシーが “未構成” となっている。"></a>2. [イントラネットの Microsoft 更新サービスの場所を指定する] ポリシーが “未構成” となっている。</h3><h4 id="要因-1"><a href="#要因-1" class="headerlink" title="要因"></a>要因</h4><p>通常、Configuration Manager（ソフトウェア更新ポイントの機能を使用している場合）クライアントであれば、以下のポリシーが “有効” になっており、WSUS サーバーが入力されています。  </p><p>[コンピューターの構成] - [管理用テンプレート] - [Windows Update] - [イントラネットの Microsoft 更新サービスの場所を指定する]  </p><p><img src="/blog/mecm/20230220_01/2023-02-20-11-10-23.png"></p><p>しかし、何らかの要因により上記ポリシーがリセットされ、”未構成” となってしまっている場合は WSUS サーバーに更新プログラムをチェックしに行かず、Microsoft Update に対して更新プログラムをチェックしに行くため、意図していない OS のアップグレードが行われる可能性がございます。<br>今までは Configuration Manager で更新プログラムの管理ができており、特段何もしていないにも関わらず上記ポリシーが “未構成” になってしまった場合には個別の調査が必要でございますので、弊社サポートへのお問い合わせをご検討いただけますと幸いです。  </p><h4 id="対処策-1"><a href="#対処策-1" class="headerlink" title="対処策"></a>対処策</h4><p>一時的な対処としては以下のポリシーを “無効” とすることで、クライアント端末が自動で Windows Update が実行されることを無効にすることができます。  </p><p>[コンピューターの構成] - [管理用テンプレート] - [Windows Update] - [自動更新を構成する]  </p><p>[自動更新を構成する] ポリシーを “無効” にしても、手動で [更新プログラムのチェック] を行うことは可能なため、上述の [Windows Update のすべての機能へのアクセスを削除する] ポリシーと合わせて適用することで、自動 / 手動ともに Windows Update が実行されなくなりますので、ご検討ください。  </p><p>ただし、ソフトウェア更新プログラムを Configuration Manager で管理しているクライアントにおいて、 [イントラネットの Microsoft 更新サービスの場所を指定する] ポリシーが “未構成” であることは本来あるべき状態ではございません。<br>根本解決のためにはトラブルシューティングが必要のため、弊社サポートへのお問い合わせをご検討ください。  </p><h4 id="補足事項"><a href="#補足事項" class="headerlink" title="補足事項"></a>補足事項</h4><p>今回は Configuration Manager 環境のクライアントについて記載いたしましたが、WSUS 環境のクライアントでも以下 3 つのポリシーを “有効” とすることで、意図せずにインターネットから機能更新プログラムを取得し、OS のアップグレードが行われることを阻止できますので、貴社環境の運用に合わせて適用ください。  </p><ul><li>[Windows Update のすべての機能へのアクセスを削除する] : 有効</li><li>[インターネット上の Windows Update に接続しない] : 有効</li><li>[Windows Update のすべての機能へのアクセスをオフにする] : 有効</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チーム 山田 です。&lt;/p&gt;
&lt;p&gt;本日は、Configuration Manager 環境にてクライアントの OS が意図せずアップグレードしてしまった際の要因と対処策についてご紹介いたします。&lt;</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>Configuration Manager における更新プログラムの適用状況の確認方法について</title>
    <link href="https://jpmem.github.io/blog/mecm/20230217_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20230217_01/</id>
    <published>2023-02-16T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.505Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>本日は Configuration Manager で更新プログラムを管理している環境において、更新プログラムの適用状況を確認する方法をご紹介いたします。<br>更新プログラムの適用状況を確認する方法は複数ありますが、それぞれ反映されるタイミングが異なりますので、用途に応じて使い分けていただければと思います。</p><h1 id="管理コンソールから確認する方法"><a href="#管理コンソールから確認する方法" class="headerlink" title="管理コンソールから確認する方法"></a>管理コンソールから確認する方法</h1><p>Configuration Manager の管理者が管理コンソールから、更新プログラムの適用状況を確認する方法です。<br>通常の運用では、更新プログラムの展開を行った後、まずこちらで確認することが多くなるかと思います。</p><h2 id="1-展開ステータスから確認"><a href="#1-展開ステータスから確認" class="headerlink" title="1. 展開ステータスから確認"></a>1. 展開ステータスから確認</h2><p>展開ステータスは、更新プログラムの展開を受信したクライアントの進行状況の概要を把握するために有用です。<br>展開単位で各ステータスの割合やそのステータスを報告したクライアントの一覧を確認できますので、現在の進行状況がおおよそどれくらいになっているかを把握するために使います。<br>但し、クライアントから報告された状態メッセージをもとに概要処理が行われた後の概要データを参照している画面となるため、実際のクライアントの適用状況が時間差で反映されることがあります。<br>そのため、最新の適用状態を確認する場合は、レポートを使用します。</p><p><img src="/blog/mecm/20230217_01/01.png" alt="image.png">  </p><h2 id="2-展開レポートを確認"><a href="#2-展開レポートを確認" class="headerlink" title="2. 展開レポートを確認"></a>2. 展開レポートを確認</h2><p>展開レポートはクライアントから報告された状態メッセージのデータを表示するため、状態メッセージが正しく報告されている状態であれば、クライアントの最新状況を正確に把握することができます。<br>そのため、展開ステータスで概要を把握した後、特定のクライアントの状態を把握するときに使用します。</p><p>まず、「状態 1 - 展開の強制実行状態」レポートを確認します。<br>このレポートでは検索条件に指定した展開において、最終状態毎に分類されてレコードが表示されます。そのため、対象の展開全体において、どの状態になっているクライアントが多いかを把握することができます。（展開ステータスで確認できる情報と同じものですが、概要処理実行前でも確認可能ですので、こちらの方がリアルタイムに把握できます。）</p><p><img src="/blog/mecm/20230217_01/02.png" alt="image.png">  </p><p>このレポートで展開名列のリンクをクリックすると、「状態 4 - 展開の特定の状態にあるコンピューター (セカンダリ)」レポートが開きます。<br>このレポートでは、その状態にあるコンピューターの一覧が表示されます。エラー ステータス ID や説明の列があるので、エラーが発生した場合において具体的なエラー内容を把握するために使用できます。</p><p><img src="/blog/mecm/20230217_01/03.png" alt="image.png">  </p><p>展開に複数の更新プログラムが含まれている場合、その展開の特定のクライアントの状態を知りたい場合は、「状態 3 - 展開とコンピューターの状態」レポートを開きます。<br>このレポートでは、検索条件に指定したコンピューターにおいて、対象の展開に含まれる更新プログラムの状態が一覧となって表示されるので、その展開に含まれる更新プログラムの適用状況を把握するために使用できます。</p><p><img src="/blog/mecm/20230217_01/04.png" alt="image.png">  </p><h2 id="3-Windows-Servicing-ダッシュボード-旧-Windows-10-ダッシュボード-を確認"><a href="#3-Windows-Servicing-ダッシュボード-旧-Windows-10-ダッシュボード-を確認" class="headerlink" title="3. Windows Servicing ダッシュボード (旧 Windows 10 ダッシュボード) を確認"></a>3. Windows Servicing ダッシュボード (旧 Windows 10 ダッシュボード) を確認</h2><p>Windows Servicing ダッシュボードでは、機能更新プログラムや品質更新プログラムのバージョンの内訳が円グラフとなって表示されます。Windows 10/11 の場合、品質更新プログラムを適用すると、特定のバージョンになりますので、品質更新プログラムの適用状況はダッシュボードで、そのバージョンになっているかどうかを確認することによっても把握できます。<br>円グラフ内で、確認したいバージョンの部分をクリックすると、そのバージョンになっているデバイスの一覧が表示されますので、適用状況を確認したいクライアントがその一覧に表示されるかどうかを確認するために使用できます。</p><p><img src="/blog/mecm/20230217_01/05.png" alt="image.png">  </p><h1 id="クライアントのログから確認する方法"><a href="#クライアントのログから確認する方法" class="headerlink" title="クライアントのログから確認する方法"></a>クライアントのログから確認する方法</h1><p>特定のクライアントで更新プログラムが配信されているかどうかを確認する場合の、確認方法です。<br>こちらは更新プログラムを配信したクライアント端末内に存在するログから確認する方法となります。</p><h2 id="1-ReportingEvents-log-による確認"><a href="#1-ReportingEvents-log-による確認" class="headerlink" title="1. ReportingEvents.log による確認"></a>1. ReportingEvents.log による確認</h2><p>最も簡易的な確認方法です。%windir%\SoftwareDistribution\ReportingEvents.log より、[AGENT_INSTALLING_SUCCEEDED] イベントが CcmExec により Success となっているか確認します。<br>このログが記録されている場合 Configuration Manager クライアントによって更新プログラムがインストールされたことになります。</p><p>例）<br>%windir%\SoftwareDistribution\ReportingEvents.log</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;08785487-DDB3-4BA7-A32D-97DA31E119DD&#125;    2023-02-10 19:52:59:896+0900          1            183 [AGENT_INSTALLING_SUCCEEDED]       101        &#123;9CB4EAAF-1485-435A-9198-2B452F1DC644&#125;             200        0              CcmExec             Success              Content Install              Installation Successful: Windows successfully installed the following update: 2022-12 Cumulative Update for .NET Framework 3.5, 4.8 and 4.8.1 for Windows 10 Version 21H2 for x64 (KB5021088)      KszDqsCb7UmIDeso.14.0.0.3.0.0</span><br></pre></td></tr></table></figure><p>★ 2023/2/10 に CcmExec による「2022-12 Cumulative Update for .NET Framework 3.5, 4.8 and 4.8.1 for Windows 10 Version 21H2 for x64 (KB5021088)」のインストールが成功したことを示すログです。</p><h2 id="2-UpdateDeployment-log-による確認"><a href="#2-UpdateDeployment-log-による確認" class="headerlink" title="2. UpdateDeployment.log による確認"></a>2. UpdateDeployment.log による確認</h2><p>Configuration Manager クライアントによって更新プログラムのダウンロードからインストールが行われた経緯を追跡するために有用な確認方法です。<br>まず、%windir%\CCM\Logs\UpdatesDeployment.log の以下のログより、更新プログラムの Update ID を確認します。</p><p>例)<br>%windir%\CCM\Logs\UpdatesDeployment.log</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2-03-2023 18:17:12.599    UpdatesDeploymentAgent    4012 (0xfac)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Name (2022-12 Cumulative Update for .NET Framework 3.5, 4.8 and 4.8.1 for Windows 10 Version 21H2 for x64 (KB5021088)) ArticleID (5021088) added to the targeted list of deployment (&#123;B92846E4-0C5A-43CD-AF30-25C2074BB30E&#125;)</span><br></pre></td></tr></table></figure><p>「2022-12 Cumulative Update for .NET Framework 3.5, 4.8 and 4.8.1 for Windows 10 Version 21H2 for x64 (KB5021088)」の UpdateID は、9cb4eaaf-1485-435a-9198-2b452f1dc644 であることがわかります。</p><p>後は確認した Update ID でログをフィルターして、「Progress: Status =」となっているログの記録を追跡します。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">02-03-2023 18:17:12.599    UpdatesDeploymentAgent    4012 (0xfac)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Name (2022-12 Cumulative Update for .NET Framework 3.5, 4.8 and 4.8.1 for Windows 10 Version 21H2 for x64 (KB5021088)) ArticleID (5021088) added to the targeted list of deployment (&#123;B92846E4-0C5A-43CD-AF30-25C2074BB30E&#125;)</span><br><span class="line">02-03-2023 18:17:12.802    UpdatesDeploymentAgent    8044 (0x1f6c)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateDownloading, PercentComplete = 0, Result = 0x0</span><br><span class="line">...</span><br><span class="line">02-03-2023 18:17:35.748    UpdatesDeploymentAgent    4012 (0xfac)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateDownloading, PercentComplete = 100, Result = 0x0</span><br></pre></td></tr></table></figure><p>★このタイミングでダウンロードが完了しました。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">02-10-2023 18:21:09.965    UpdatesDeploymentAgent    4048 (0xfd0)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateDownloading, PercentComplete = 0, Result = 0x0</span><br><span class="line">02-10-2023 18:21:10.630    UpdatesDeploymentAgent    7648 (0x1de0)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateDetecting, PercentComplete = 0, DownloadSize = 0, Result = 0x0</span><br><span class="line">02-10-2023 18:21:10.661    UpdatesDeploymentAgent    5888 (0x1700)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateDownloading, PercentComplete = 0, DownloadSize = 0, Result = 0x0</span><br><span class="line">02-10-2023 18:21:10.911    UpdatesDeploymentAgent    7996 (0x1f3c)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateWaitInstall, PercentComplete = 0, DownloadSize = 0, Result = 0x0</span><br><span class="line">...</span><br><span class="line">02-10-2023 18:22:23.108    UpdatesDeploymentAgent    3540 (0xdd4)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateInstalling, PercentComplete = 100, DownloadSize = 0, Result = 0x0</span><br><span class="line">02-10-2023 18:22:23.186    UpdatesDeploymentAgent    7996 (0x1f3c)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStatePendingSoftReboot, PercentComplete = 0, DownloadSize = 0, Result = 0x0</span><br></pre></td></tr></table></figure><p>★このタイミングでインストールが完了し、再起動待ちとなりました。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">02-10-2023 19:55:29.081    UpdatesDeploymentAgent    5056 (0x13c0)    Update (Site_04BBD5B3-EC61-46B0-82C1-83C6B832829D/SUM_9cb4eaaf-1485-435a-9198-2b452f1dc644) Progress: Status = ciStateInstallComplete, PercentComplete = 0, DownloadSize = 0, Result = 0x0</span><br></pre></td></tr></table></figure><p>★このタイミングでインストールが成功しました。</p><p>なお、どこの配布ポイントからダウンロードしたかについては、UpdatesDeployment.log には記録されません。<br>ダウンロード元となる配布ポイントを確認する場合は、UpdatesDeployment.log よりダウンロードが開始された時間を把握した後、DataTrasnferServices.log より確認します。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">02-03-2023 18:17:13.544    DataTransferService    4012 (0xfac)    DataTransferService: DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;) - created to download from &#x27;http://ADA-PS1SITE.adatum.com:80/SMS_DP_SMSPKG$/f65c14ba-94ac-4d7f-847c-ecaf000d1bed&#x27; to &#x27;C:\Windows\ccmcache\1p&#x27;.</span><br><span class="line">02-03-2023 18:17:13.544    DataTransferService    8044 (0x1f6c)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): state changing from &#x27;New&#x27; to state &#x27;DownloadingManifest&#x27;.</span><br><span class="line">02-03-2023 18:17:13.794    DataTransferService    6444 (0x192c)    Raising event:</span><br><span class="line"> </span><br><span class="line">instance of CCM_CcmHttp_Status</span><br><span class="line">&#123;</span><br><span class="line">              ClientID = &quot;GUID:DB715499-3414-4055-B873-278BAE1B73C4&quot;;</span><br><span class="line">              DateTime = &quot;20230203091713.794000+000&quot;;</span><br><span class="line">              HostName = &quot;ADA-PS1SITE.adatum.com&quot;;</span><br><span class="line">              HRESULT = &quot;0x00000000&quot;;</span><br><span class="line">              ProcessID = 6776;</span><br><span class="line">              StatusCode = 0;</span><br><span class="line">              ThreadID = 6444;</span><br><span class="line">&#125;;</span><br><span class="line">02-03-2023 18:17:13.794    DataTransferService    6444 (0x192c)    UpdateURLWithTransportSettings(): OLD URL - http://ada-ps1site.adatum.com/SMS_DP_SMSPKG$/sccm?/f65c14ba-94ac-4d7f-847c-ecaf000d1bed/</span><br><span class="line">02-03-2023 18:17:13.794    DataTransferService    6444 (0x192c)    UpdateURLWithTransportSettings(): NEW URL - http://ada-ps1site.adatum.com:80/SMS_DP_SMSPKG$/sccm?/f65c14ba-94ac-4d7f-847c-ecaf000d1bed/</span><br><span class="line">02-03-2023 18:17:13.794    DataTransferService    6444 (0x192c)    UpdateURLWithTransportSettings(): OLD URL - http://ada-ps1site.adatum.com/SMS_DP_SMSPKG$/f65c14ba-94ac-4d7f-847c-ecaf000d1bed/sccm?/Windows10.0-KB5020872-x64-NDP48.cab</span><br><span class="line">02-03-2023 18:17:13.794    DataTransferService    6444 (0x192c)    UpdateURLWithTransportSettings(): NEW URL - http://ada-ps1site.adatum.com:80/SMS_DP_SMSPKG$/f65c14ba-94ac-4d7f-847c-ecaf000d1bed/sccm?/Windows10.0-KB5020872-x64-NDP48.cab</span><br><span class="line">02-03-2023 18:17:13.794    DataTransferService    6444 (0x192c)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): state changing from &#x27;DownloadingManifest&#x27; to state &#x27;RetrievedManifest&#x27;.</span><br><span class="line">02-03-2023 18:17:13.810    DataTransferService    4012 (0xfac)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): state changing from &#x27;RetrievedManifest&#x27; to state &#x27;PendingDownload&#x27;.</span><br><span class="line">02-03-2023 18:17:13.810    DataTransferService    2536 (0x9e8)    DTSFlag is 0x0040050e</span><br><span class="line">02-03-2023 18:17:13.810    DataTransferService    2536 (0x9e8)    ContentInfo root location - C:\Windows\ccmcache\1p.BCWork\ContentInfo</span><br><span class="line">02-03-2023 18:17:13.810    DataTransferService    2536 (0x9e8)    Exclude file list:</span><br><span class="line">02-03-2023 18:17:13.810    DataTransferService    2536 (0x9e8)    Using branch cache option</span><br><span class="line">02-03-2023 18:17:13.826    DataTransferService    2536 (0x9e8)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): state changing from &#x27;PendingDownload&#x27; to state &#x27;DownloadingData&#x27;.</span><br><span class="line">02-03-2023 18:17:35.983    DataTransferService    4764 (0x129c)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): state changing from &#x27;DownloadingData&#x27; to state &#x27;RetrievedData&#x27;.</span><br><span class="line">02-03-2023 18:17:35.983    DataTransferService    4764 (0x129c)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;):CDTSJob::JobTransferred - Successfully completed download.</span><br><span class="line">02-03-2023 18:17:36.061    DataTransferService    2536 (0x9e8)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): state changing from &#x27;RetrievedData&#x27; to state &#x27;NotifiedComplete&#x27;.</span><br><span class="line">02-03-2023 18:17:36.061    DataTransferService    2536 (0x9e8)    DTSJob(&#123;5FA19A95-19E4-4EA4-8B5F-03251C093633&#125;): Job has completed: Status : SUCCESS, Start time : 02/03/2023 18:17:13, Completion time : 02/03/2023 18:17:35, Elapsed time : 22 seconds</span><br></pre></td></tr></table></figure><p>★ ada-ps1site.adatum.com がダウンロード元であることがわかります。ダウンロードの経緯については DTSJob の ID でログをフィルターすることで追跡可能です。このログの場合は {5FA19A95-19E4-4EA4-8B5F-03251C093633} でフィルターすることになります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;本日は Configuration Manager で更新プログラムを管理している環境において、更新プログラムの適用状況を確認する方法をご紹介いたします。&lt;br&gt;更新</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>WSUS 構築マニュアル</title>
    <link href="https://jpmem.github.io/blog/wsus/2023-02-16_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2023-02-16_01/</id>
    <published>2023-02-15T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.641Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。WSUS サポート チームです。今回は、WSUS 構築手順についてご紹介します。WSUS 環境構築予定の方は是非ご一読ください。</p><hr><h2 id="WSUS-環境構築手順"><a href="#WSUS-環境構築手順" class="headerlink" title="WSUS 環境構築手順"></a>WSUS 環境構築手順</h2><ul><li>手順<br>a. 役割と機能のインストール<br>b. WSUS の設定  </li></ul><h3 id="a-役割と機能のインストール"><a href="#a-役割と機能のインストール" class="headerlink" title="a. 役割と機能のインストール"></a>a. 役割と機能のインストール</h3><p>サーバー マネージャーを使用して、WSUS サーバー、IIS、Windows Internal Database の役割と機能をインストールします。<br>なお、WSUS サーバーのデータベースに、SQL Server をご利用の場合は、利用するデータベースを指定する際にインスタンス名をご指定ください。  </p><ol><li>[サーバー マネージャー] を起動します。  </li><li>画面右上の [管理] メニューを選択し、[役割と機能の追加]を選択します。  </li><li>[開始する前に] ページにて、[次へ] ボタンを選択します。  </li><li>[サーバーの選択] ページにて、[次へ] ボタンを選択します。  </li><li>[サーバーの役割] ページにて、[Windows Server Update Services] チェック ボックスをオンにします。</li><li>[役割と機能の追加ウィザード] ダイアログ ボックスが表示されます。<br>[管理ツールを含める (存在する場合)] チェック ボックスがオンであることを確認し、 [機能の追加] ボタンを選択します。</li><li>[Web サーバー (IIS)] のチェックが入っていることを確認します。  </li><li>[次へ] を選択します。  </li><li>[機能] ページにて、 Windows Internal Database をご利用の場合には　[Windows Internal Database] チェック ボックスがオンであることを確認します。SQL サーバーをご利用の場合には　[Windows Internal Database] チェック ボックスをオフにします。</li><li>[次へ] を選択します。  </li><li>[WSUS]ページにて、[次へ] ボタンを選択します。  </li><li>[役割サービス]ページにて、WSUS で使用するデータベースを指定します。Windows Internal Database をご利用の場合には、WID Connectivity へのチェックをオンにします。SQL サーバーをご利用の場合には、SQL Server Connectivity へのチェックをオンにします。 Windows Internal Database 又は SQL サーバーいずれをご利用の場合も、WSUS Services へのチェックは必ずオンのままとします。</li><li>[コンテンツ] ページにて、更新プログラムのコンテンツの格納場所となるフォルダー (WsusContent フォルダー) の場所を指定します。</li><li><ol start="12"><li>にて、SQL Server Connectivity を選択した場合には、DBインスタンスを指定し、[接続を確認する]を押下します。</li></ol></li><li>[WSUSサーバーの役割（IIS）]ページにて、[次へ] ボタンを選択します。  </li><li>[役割サービス]ページにて、[次へ] ボタンを選択します。  </li><li>[確認] ページにて、[インストール] ボタンを選択します。  </li><li>WSUS のインストールが完了した後、サーバー マネージャー 右上フラグマークのアイコンより [インストール後のタスクを起動する] をクリックします。 テキストが 「サーバーが構成されるまでしばらくお待ちください」に変わります。 タスクが完了後、 「構成は正常に完了しました」が表示されることを確認します。<br><img src="/blog/wsus/2023-02-16_01/2023-02-16_01_1.png"></li></ol><h3 id="b-WSUS-の設定"><a href="#b-WSUS-の設定" class="headerlink" title="b. WSUS の設定"></a>b. WSUS の設定</h3><ol><li>[サーバー マネージャー] を起動します。  </li><li>右上[ツール]より、[Windows Server Update Services] を選択します。</li><li>[はじめに] ページにて、[次へ]　ボタンを選択します。</li><li>[Microsoft Update 品質向上プログラム] ページにて、[次へ]　ボタンを選択します。(任意で選択ください)</li><li>[アップストリームサーバーの選択] ページにて、更新プログラムの同期元を選択します。 </li><li>プロキシを指定する場合は、[プロキシサーバーの指定] ページにて設定し、[次へ]　ボタンを選択します。</li><li>[接続の開始] をクリックし、更新情報をダウンロードします。 </li><li>[言語の選択] ページにて、英語（必須）及び必要に応じて追加言語を指定してください。  </li><li>[製品の選択] ページにて、同期対象とする製品を選択します。</li><li>[分類の選択] ページにて、同期対象とする分類を選択します。  </li><li>[同期スケジュールの設定] ページにて、同期スケジュールを指定します。  </li><li>[終了] ページにて、初期同期を開始する場合には[初期同期を開始します] チェック ボックスをオンにします。 </li><li>[完了] ボタンをクリックします。</li></ol><p>※8. 言語の選択においては、すべての更新プログラムは英語の言語パックに基づくため、必ず英語を含めてください。<br><a href="https://learn.microsoft.com/ja-jp/windows-server/administration/windows-server-update-services/plan/plan-your-wsus-deployment#14-choose-wsus-update-languages">WSUS 更新プログラムの言語を選択する</a><br>※9. 製品名に”drivers”や”upgrade &amp; servicing drivers”含まれる製品項目は、ドライバー製品向けの更新プログラムです。該当製品のドライバーに対して更新が必要な場合のみ選択してください。<br>※10. 分類についてはこちらをご参照ください。<br> <a href="https://jpmem.github.io/blog/wsus/2018-06-19_01/">WSUS の分類について</a><br>上記ブログの 「ポイント : 特別な利用がない限り [ドライバ] の分類は絶対に選択しない」 に記載の通り、[ドライバ] の分類は、リリースされている更新プログラムの数が非常に多く、同期対象としますと数万件の更新プログラムが同期され、WSUS のパフォーマンスに大きな影響を与える可能性が高い為、チェックは入れないことをお勧めいたします。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。WSUS サポート チームです。今回は、WSUS 構築手順についてご紹介します。WSUS 環境構築予定の方は是非ご一読ください。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;WSUS-環境構築手順&quot;&gt;&lt;a href=&quot;#WSUS-環境構築手順&quot; class=&quot;h</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
    <category term="構築マニュアル" scheme="https://jpmem.github.io/blog/tags/%E6%A7%8B%E7%AF%89%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/"/>
    
  </entry>
  
  <entry>
    <title>Window Server 2022 にて WSUS コンソールの言語表示が日本語にならない</title>
    <link href="https://jpmem.github.io/blog/wsus/2022-10-07_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2022-10-07_01/</id>
    <published>2022-10-06T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.637Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。WSUS サポート チームです。今回は、Windows Server 2022 における、WSUS コンソールの表示言語で確認された既知の不具合についてお伝えいたします。</p><h1 id="WSUS-コンソールの表示言語について"><a href="#WSUS-コンソールの表示言語について" class="headerlink" title="WSUS コンソールの表示言語について"></a>WSUS コンソールの表示言語について</h1><p>WSUS コンソールは、OS の言語表示と同じ言語で表示されます。しかしながら、Windows Server 2022 では、2022 年 6 月以前の更新プログラム適用環境において、WSUS コンソールが英語表示のままとなる事象が確認されております。<br><img src="/blog/wsus/2022-10-07_01/2022-10-07_01_1.png"></p><h1 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h1><p>本事象は弊社既知の不具合として確認されており、本事象に対する修正を含む更新プログラム KB5014665 がリリースされております。この修正内容を含む更新プログラムを適用することにより、WSUS コンソールが、OS の言語表示に従って表示されます。</p><p><a href="https://support.microsoft.com/ja-jp/topic/2022-%E5%B9%B4-6-%E6%9C%88-23-%E6%97%A5%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E4%BB%A5%E5%A4%96%E3%81%AE%E6%9B%B4%E6%96%B0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0-kb5014665-108cb23c-8e38-4eb4-974a-b5a30d4bc0c4">2022 年 6 月 23 日セキュリティ以外の更新プログラム (KB5014665)</a>  </p><p>（上記リリース以降の累積更新プログラムには、この修正内容が含まれております。）</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。WSUS サポート チームです。今回は、Windows Server 2022 における、WSUS コンソールの表示言語で確認された既知の不具合についてお伝えいたします。&lt;/p&gt;
&lt;h1 id=&quot;WSUS-コンソールの表示言語について&quot;&gt;&lt;a href</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
  </entry>
  
  <entry>
    <title>画面キャプチャの取得を禁止する方法</title>
    <link href="https://jpmem.github.io/blog/w365/2022-10-06_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-10-06_01/</id>
    <published>2022-10-05T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.541Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田 です。<br>本日は、ユーザーがクラウド PC 上で画面キャプチャの取得を禁止する方法についてご紹介させていただきます。  </p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/10/6 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="テンプレートの取得"><a href="#テンプレートの取得" class="headerlink" title="テンプレートの取得"></a>テンプレートの取得</h3><ol><li><p>以下のリンクより、Azure Virtual Desktop 用のテンプレートをダウンロードします。<br><a href="https://aka.ms/avdgpo">AVDGPTemplate.cab</a>  </p></li><li><p>AVDGPTemplate.cab を展開し、フォルダーから以下 2 つのファイルを取り出します。  </p></li></ol><p>terminalserver-avd.admx<br>en-us\terminalserver-avd.adml  </p><ol start="3"><li>ドメイン コントローラー（ドメイン のグループ ポリシーで制御する場合）、またはクラウド PC（ローカル グループ ポリシーで制御する場合）上の以下のパスにそれぞれのファイルを保存します。  </li></ol><p>terminalserver-avd.admx 　　  →　%windir%\PolicyDefinitions フォルダー<br>en-us\terminalserver-avd.adml  →　%windir%\PolicyDefinitions\en-us フォルダー  </p><ol start="4"><li>以下のポリシーを “有効” に設定します。  </li></ol><p>[コンピューターの構成] - [ポリシー] - [管理用テンプレート] - [Windows コンポーネント] - [リモート デスクトップ サービス] - [リモート デスクトップ セッション ホスト] - [Azure Virtual Desktop]<br>“Enable screen capture protection”  </p><ol start="5"><li>クラウド PC の画面キャプチャが取得できないことを確認します。  </li></ol><h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p>本ポリシーは Windows や mac の端末からリモート デスクトップ アプリでクラウド PC に接続している場合にのみ動作いたします。<br>ブラウザー経由での接続や、iPad からの接続は、クラウド PC への接続自体に失敗しますので、予めご承知おきください。  </p><p>■参考公開情報<br><a href="https://learn.microsoft.com/ja-jp/azure/virtual-desktop/screen-capture-protection#prerequisites">前提条件</a>  </p><p>以上、画面キャプチャの取得を禁止する方法のご紹介でした。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田 です。&lt;br&gt;本日は、ユーザーがクラウド PC 上で画面キャプチャの取得を禁止する方法についてご紹介させていただきます。  &lt;/p&gt;
&lt;h2 id=&quot;免責事項&quot;&gt;&lt;a href=&quot;#</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>知ってよかった！3 分でわかる！Microsoft Intuneチームが綴る、問題解決の時間短縮術</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_00/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_00/</id>
    <published>2022-09-29T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.209Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームのIshikawaです。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポート チームへお問い合わせをご起票いただく際にお客様側で<strong>事前に採取可能な情報</strong>についてお纏めいたします。</p><p><strong>皆様の問題解決を、少しでもスムーズに支援することが可能になるためです。</strong></p><p>多くのお問い合わせにおいては、調査開始にあたり事象発生デバイスの情報が必要となります。</p><p>その場合、必要な情報の採取をお客様に依頼させていただきますが、依頼後に情報を採取いただき、私共にて受領するまでに平均 <strong>”1日~2日”</strong> を要しているのが実状です。</p><p>お問い合わせの起票前に情報を採取いただき、その情報とともにお問い合わせの起票をいただきますと、調査開始までの時間を現状より早められ、問題解決のためのご支援をよりスムーズに行える可能性がございます。</p><h1 id="どんな情報採取が効果的か"><a href="#どんな情報採取が効果的か" class="headerlink" title="どんな情報採取が効果的か"></a>どんな情報採取が効果的か</h1><p><strong>シナリオによって様々に異なります。</strong></p><p><strong>事前に「この情報だけ採取しておけばすべての調査が可能」という情報採取方法はございません。</strong><br>お問い合わせ内容、お客様の環境で起きている事象に応じて情報採取の内容や方法も変わってまいります。事象によっては、採取情報で判明した内容を元に、問題解決に向けて更なる情報採取をお願いさせていただくこともございます。</p><p>そのため必ず効果を得られるというものではありませんが、一方で、ある程度パターン化できるものがあり、その部分を事前に私共から皆様にお知らせすることで、よりスムーズな問題解決支援が可能となるのではないか、という思いから本投稿を記載しております。</p><h1 id="お客様に採取をお願いしたい情報"><a href="#お客様に採取をお願いしたい情報" class="headerlink" title="お客様に採取をお願いしたい情報"></a>お客様に採取をお願いしたい情報</h1><p>今回ご案内いたしますのは、Intune チームからお客様に依頼させていただくことがある情報採取の中で、最も基本的なものです。「最も基本的」とは、もし採取可能な状況であれば、お問い合わせ起票に先立ち、どのようなシナリオにおいても可能な限り準備いただきたい情報であることを意味します。</p><p>以下、後述 URL の Intune チームブログにて詳しい情報採取手順をご紹介しております。手順に沿って情報を採取いただき、お問い合わせの起票時にご提供いただけますと幸いです。</p><h2 id="どのような事象発生時にも採取をお願いしたい情報"><a href="#どのような事象発生時にも採取をお願いしたい情報" class="headerlink" title="どのような事象発生時にも採取をお願いしたい情報"></a>どのような事象発生時にも採取をお願いしたい情報</h2><ul><li>UPN</li><li>Intune デバイス ID</li><li>AAD デバイス ID</li><li>シリアル番号</li></ul><p>ご起票時に事前採取可能な基本情報の採取手順 &lt; <a href="https://jpmem.github.io/blog/intune/20220913_01/">https://jpmem.github.io/blog/intune/20220913_01/</a> &gt;</p><h2 id="モバイル端末を-Intune-に登録できない場合などに事前採取をお願いしたい情報"><a href="#モバイル端末を-Intune-に登録できない場合などに事前採取をお願いしたい情報" class="headerlink" title="モバイル端末を Intune に登録できない場合などに事前採取をお願いしたい情報"></a>モバイル端末を Intune に登録できない場合などに事前採取をお願いしたい情報</h2><ul><li>Intune ポータルサイトアプリのインシデント ID (iOS and Android)</li><li>MAM ログ</li></ul><p>ご起票時に事前採取可能なモバイルデバイス情報の採取手順 &lt; <a href="https://jpmem.github.io/blog/intune/20220913_02/">https://jpmem.github.io/blog/intune/20220913_02/</a> &gt;</p><h2 id="Autopilot-が失敗している場合に事前採取をお願いしたい情報"><a href="#Autopilot-が失敗している場合に事前採取をお願いしたい情報" class="headerlink" title="Autopilot が失敗している場合に事前採取をお願いしたい情報"></a>Autopilot が失敗している場合に事前採取をお願いしたい情報</h2><ul><li>Autopilot のログ</li></ul><p>ご起票時に事前採取可能な Autopilot ログの採取手順 &lt; <a href="https://jpmem.github.io/blog/intune/20220913_03/">https://jpmem.github.io/blog/intune/20220913_03/</a> &gt;</p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームのIshikawaです。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポート チームへお問い合わ</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2022-37972 Microsoft Endpoint Configuration Manager の脆弱性について</title>
    <link href="https://jpmem.github.io/blog/mecm/20220930_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220930_01/</id>
    <published>2022-09-29T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.505Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>本日は、米国時間 2022/09/20 (日本時間 2022/09/21) にリリースされた、Microsoft Endpoint Configuration Manager の脆弱性について取り上げます。  </p><p>Title : Microsoft Endpoint Configuration Manager Spoofing Vulnerability　CVE-2022-37972<br>URL : <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-37972">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-37972</a>  </p><hr><h2 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h2><p>こちらの脆弱性は KB15599094 を適用することで対処することが出来ます。  </p><p>Title : Microsoft Endpoint Configuration Managerの NTLM クライアント インストール更新プログラム<br>URL : <a href="https://learn.microsoft.com/ja-jp/mem/configmgr/hotfix/2207/15599094">https://learn.microsoft.com/ja-jp/mem/configmgr/hotfix/2207/15599094</a>  </p><h3 id="KB15599094-の適用対象バージョン"><a href="#KB15599094-の適用対象バージョン" class="headerlink" title="KB15599094 の適用対象バージョン"></a>KB15599094 の適用対象バージョン</h3><p>Microsoft Endpoint Configuration Manager バージョン 2103,2107,2111,2203,2207 が適用対象となります。  </p><h3 id="KB15599094-のインストール方法"><a href="#KB15599094-のインストール方法" class="headerlink" title="KB15599094 のインストール方法"></a>KB15599094 のインストール方法</h3><p>適用対象のバージョンの Configuration Manager コンソールにて、下記のように、KB15599094 が表示されます。表示されている KB15599094 を右クリック - [ダウンロード] を実行後、ダウンロードが完了しましたら [更新プログラム パックのインストール] をクリックしインストールを行います。<br><img src="/blog/mecm/20220930_01/01.png" alt="image.png">  </p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><p>・KB15599094 は対象がサイト サーバーとなりますので、エージェントの更新は不要となります。<br>ただし、サイト サーバーが適用対象とされていますので、お客様環境下においてセカンダリ サイトを構成している場合には、下記公開情報の「その他のインストール情報」に記載の通り、手動で更新する必要がございます。  </p><p>Title : その他のインストール情報<br>URL : <a href="https://learn.microsoft.com/ja-jp/mem/configmgr/hotfix/2207/15599094#additional-installation-information">https://learn.microsoft.com/ja-jp/mem/configmgr/hotfix/2207/15599094#additional-installation-information</a>  </p><p>・既にサポートが終了している Microsoft Endpoint Configuration Manager バージョンにつきましては、KB15599094 が Configuration Manager コンソール上に表示されません。その為、サポート対象のバージョン 2103 以降へバージョン アップして頂き、KB15599094 を適用して下さいませ。  </p><p>・Microsoft Endpoint Configuration Manager バージョン 2103,2107,2111,2203,2207 向けにリリースされている KB15498768 は期限切れの更新プログラムであり、今回ご紹介した KB15599094 に置き換えられております為、KB15599094 の適用をご実施下さいませ。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;本日は、米国時間 2022/09/20 (日本時間 2022/09/21) にリリースされた、Microsoft Endpoint Configuration Man</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>ご起票時に事前採取可能な基本情報の採取手順</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_01/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_01/</id>
    <published>2022-09-27T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.209Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームの Ishikawa です。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポートチームへお問い合わせをご起票いただく際にお客様側で事前に採取可能な<strong>基本情報</strong>についてお纏めいたします。</p><p>下記内容及び、画面ショットは 2022/9/28 時点での仕様についての記載となっております。<br>弊社ではお客様のご意見を頂戴し、日々、品質向上に努めております。その為、製品アップデートが頻繁に行われており、お客様の手元環境とは表示等が異なる可能性がございますことを、予めご承知おきくださいますようお願い致します。</p><h1 id="基本情報"><a href="#基本情報" class="headerlink" title="基本情報"></a>基本情報</h1><p>今回ご案内をする情報採取手順は Intune チームからお客様にご案内をすることがある情報採取の中で最も基本的なものになります。<br><strong>この情報は、どのような事象発生時にも事前採取をお願いしたい内容になります。</strong></p><p><strong>ご案内する情報採取手順</strong></p><ul><li>UPN</li><li>Intune デバイス ID</li><li>AAD (Azure AD) デバイス ID</li><li>シリアル番号</li></ul><p>以下、情報採取手順をご説明いたします。</p><h2 id="1-事象発生デバイスの特定"><a href="#1-事象発生デバイスの特定" class="headerlink" title="1. 事象発生デバイスの特定"></a>1. 事象発生デバイスの特定</h2><p>弊社への問い合わせの際に、同一デバイス名で登録されている別デバイスの情報提供をいただくケースが少なくなく、その場合、いただいた情報からは調査が進められず、適切な調査対象デバイスにて改めて情報採取いただく必要がございます。これを避ける為、以下の手順でまずは事象発生デバイスの特定をお願いいたします。</p><p><strong>1. Microsoft Endpoint Manager admin center &lt; <a href="https://endpoint.microsoft.com/">https://endpoint.microsoft.com/</a> &gt; へログインする</strong></p><p><strong>2. 左側タブ内の [デバイス] &gt; [すべてのデバイス] の画面にて [デバイス名]、[OS]、[OSのバージョン]、[プライマリ ユーザーのUPN] を確認の上、事象発生デバイスの特定をする</strong></p><p><img src="/blog/intune/20220913_01/basic_01.png"></p><p>※ 同一デバイス名 (例 : iPhone) で複数デバイスが登録されている場合がございますので、事象発生デバイスのご確認をお願いします。</p><p>&lt;参考&gt;<br>UPN とはユーザーオブジェクトにユニークに付与されているメールアドレス形式の文字列です。<br>例) <a href="mailto:&#x73;&#x61;&#109;&#x70;&#108;&#x65;&#x40;&#105;&#x6e;&#x74;&#117;&#110;&#x65;&#46;&#x6f;&#x6e;&#109;&#x69;&#x63;&#x72;&#111;&#115;&#111;&#x66;&#116;&#x2e;&#x63;&#x6f;&#x6d;">&#x73;&#x61;&#109;&#x70;&#108;&#x65;&#x40;&#105;&#x6e;&#x74;&#117;&#110;&#x65;&#46;&#x6f;&#x6e;&#109;&#x69;&#x63;&#x72;&#111;&#115;&#111;&#x66;&#116;&#x2e;&#x63;&#x6f;&#x6d;</a></p><p>User Principal Nameとは &lt; <a href="https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/plan-connect-userprincipalname#what-is-userprincipalname">https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/plan-connect-userprincipalname#what-is-userprincipalname</a> &gt;</p><h2 id="2-事象発生デバイスの情報採取"><a href="#2-事象発生デバイスの情報採取" class="headerlink" title="2. 事象発生デバイスの情報採取"></a>2. 事象発生デバイスの情報採取</h2><!-- 前項の **1.事象発生デバイスの特定** をご確認いただきましたお客様につきましては、項目 3 以降の手順に従って事象発生デバイスの Intune デバイス ID、AAD (Azure AD) デバイス ID、シリアル番号をご確認いただけます。**1. Microsoft Endpoint Manager admin center < https://endpoint.microsoft.com/ > へログインする** --><p><strong>1. 特定した事象発生デバイスの [プライマリ ユーザーのUPN] を確認する</strong></p><p><img src="/blog/intune/20220913_01/basic_04.png"></p><p><strong>2. 事象発生デバイスのデバイス名を選択し、左側タブ内の [ハードウェア] を選択する</strong></p><p><img src="/blog/intune/20220913_01/basic_02.png"></p><p><strong>3. 表示される [Intune デバイス ID]、[Azure AD デバイス ID]、[シリアル番号] を確認する</strong></p><p><img src="/blog/intune/20220913_01/basic_03.png"></p><p><strong>4. 採取した UPN、Intune デバイス ID、Azure AD デバイス ID、シリアル番号を Microsoft 社への起票時に添付する</strong></p><p>※ 2022 年 9 月現在、Android 12 以降を実行している Android の個人所有の作業プロファイル デバイスのシリアル番号は表示されません。&lt; <a href="https://docs.microsoft.com/ja-jp/mem/intune/remote-actions/device-inventory#hardware-device-details">https://docs.microsoft.com/ja-jp/mem/intune/remote-actions/device-inventory#hardware-device-details</a> &gt;</p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。<br>本記事、または Intune に関しましてご不明点等ございましたら、Service Request（お問い合わせ）にて Intune サポートチームの担当者にお気兼ねなくご相談ください。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームの Ishikawa です。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポートチームへお問い合</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>ご起票時に事前採取可能なモバイルデバイス情報の採取手順</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_02/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_02/</id>
    <published>2022-09-27T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.213Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームの Ishikawa です。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポートチームへお問い合わせをご起票いただく際にお客様側で事前に採取可能な<strong>モバイルデバイスの情報</strong>についてお纏めいたします。</p><p>下記内容及び、画面ショットは 2022/9/28 時点での仕様についての記載となっております。<br>弊社ではお客様のご意見を頂戴し、日々、品質向上に努めております。その為、製品アップデートが頻繁に行われており、お客様の手元環境とは表示等が異なる可能性がございますことを、予めご承知おきくださいますようお願い致します。</p><h1 id="モバイルデバイスの情報"><a href="#モバイルデバイスの情報" class="headerlink" title="モバイルデバイスの情報"></a>モバイルデバイスの情報</h1><p>今回ご案内をするのは Intune チームからお客様にご案内をすることがあるモバイルデバイスの情報採取手順になります。</p><p><strong>ご案内する情報採取手順</strong></p><ul><li>Intune ポータルサイトアプリのインシデント ID</li><li>MAM (Mobile Application Management) ログ</li></ul><p>iOS 端末、Android 端末のそれぞれついてご案内いたします。</p><h2 id="1-Intune-ポータルサイトアプリのインシデント-ID"><a href="#1-Intune-ポータルサイトアプリのインシデント-ID" class="headerlink" title="1. Intune ポータルサイトアプリのインシデント ID"></a>1. Intune ポータルサイトアプリのインシデント ID</h2><p>Intune ポータルサイトアプリのインシデント ID とは Intune ポータルサイトアプリに紐づけられた ID です。<br><strong>この情報は、モバイル端末を Intune に登録できない場合などに事前採取をお願いしたい内容になります。</strong></p><p>以下の手順で事象発生デバイスのインシデント ID を採取してご提供ください。iOS 端末と Android 端末では採取の手順が異なります。</p><h3 id="iOS-端末"><a href="#iOS-端末" class="headerlink" title="[iOS 端末]"></a>[iOS 端末]</h3><p><strong>1. iOS のポータルタイトアプリを起動する</strong></p><p><img src="/blog/intune/20220913_02/ios_01_f.PNG"></p><p><strong>2. 右下の[… その他] &gt; [<font color="DeepSkyBlue"> ヘルプ </font>] をタップする</strong></p><p><img src="/blog/intune/20220913_02/ios_02_f.PNG"></p><p><img src="/blog/intune/20220913_02/ios_03_f.PNG"></p><p><strong>3. [ヘルプの取得] 画面にて使用しているインシデント ID を確認する</strong></p><p><img src="/blog/intune/20220913_02/ios_04_f.PNG"></p><p><strong>4. 採取したインシデント ID を Microsoft 社への起票時に添付する</strong></p><h3 id="Android-端末"><a href="#Android-端末" class="headerlink" title="[Android 端末]"></a>[Android 端末]</h3><p><strong>1. Android のポータルサイトアプリを起動する</strong></p><p><img src="/blog/intune/20220913_02/and_00_f.png"></p><p><strong>2. 左上の [三] &gt; [ヘルプ] をタップする</strong></p><p><img src="/blog/intune/20220913_02/and_02_f.png"></p><p><img src="/blog/intune/20220913_02/and_03_f.png"></p><p><strong>3. [ログの送信] をタップする</strong></p><p><img src="/blog/intune/20220913_02/and_04_f.png"></p><p><strong>4. [ログのみ送信] をタップし、インシデント ID を確認する</strong></p><p><img src="/blog/intune/20220913_02/and_05_f.png"></p><p><img src="/blog/intune/20220913_02/and_01_f.png"></p><p>&lt;参考&gt;<br>Android アプリ ログを Microsoft に送信する &lt; <a href="https://docs.microsoft.com/ja-jp/mem/intune/user-help/send-logs-to-microsoft-android?source=recommendations#send-logs">https://docs.microsoft.com/ja-jp/mem/intune/user-help/send-logs-to-microsoft-android?source=recommendations#send-logs</a> &gt;</p><p><strong>5. 採取したインシデント ID を Microsoft 社への起票時に添付する</strong></p><h2 id="2-MAM-Mobile-Application-Management"><a href="#2-MAM-Mobile-Application-Management" class="headerlink" title="2. MAM (Mobile Application Management)"></a>2. MAM (Mobile Application Management)</h2><p>MAM (Mobile Application Management) ログとはモバイルアプリ管理に関する操作情報の記録です。<br><strong>この情報は、アプリ保護ポリシーが適用できない場合などに事前採取をお願いしたい内容になります。</strong></p><p><strong>Android 端末の場合、MAM ログと Intune ポータルサイトアプリのインシデント ID は同一となりますので、インシデント ID を弊社にご送信いただけますと、MAM ログも弊社にて確認が取れる状態となります。</strong></p><p>以下の手順で事象発生デバイスの MAM ログを採取してご提供ください。</p><h3 id="iOS端末"><a href="#iOS端末" class="headerlink" title="[iOS端末]"></a>[iOS端末]</h3><p><strong>1. iOS の Microsoft Edge アプリを起動する</strong></p><p><img src="/blog/intune/20220913_02/IMG_7358_f.PNG"></p><p><strong>2. [検索またはWebアドレスを入力] タブにて、”about:intunehelp” と入力する</strong></p><p><img src="/blog/intune/20220913_02/IMG_7360_f.PNG"></p><p><strong>3. [Intune 診断] 画面にて、[開始する] をクリックする</strong></p><p><img src="/blog/intune/20220913_02/IMG_7364_f.PNG"></p><p><strong>4. [Intune診断の収集] 画面にて、MAM ログ (参照 ID) を確認する</strong></p><p><img src="/blog/intune/20220913_02/IMG_7363_f.PNG"></p><p><strong>5. 採取した MAM ログを Microsoft 社への起票時に添付する</strong></p><p>※ Microsoft 製品以外のアプリの場合、アプリごとにログが出力される可能性がございますので、各ベンダー様に確認いただく場合がございます。</p><p>&lt;参考&gt;<br>iOS と Android に Edge を使用してマネージド アプリ ログにアクセスする &lt; <a href="https://docs.microsoft.com/ja-jp/mem/intune/apps/manage-microsoft-edge#use-edge-for-ios-and-android-to-access-managed-app-logs">https://docs.microsoft.com/ja-jp/mem/intune/apps/manage-microsoft-edge#use-edge-for-ios-and-android-to-access-managed-app-logs</a> &gt;</p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。<br>本記事、または Intune に関しましてご不明点等ございましたら、Service Request（お問い合わせ）にて Intune サポートチームの担当者にお気兼ねなくご相談ください。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームの Ishikawa です。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポートチームへお問い合</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>ご起票時に事前採取可能な Autopilot ログの採取手順</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_03/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_03/</id>
    <published>2022-09-27T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.269Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームの Ishikawa です。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポート チームへお問い合わせをご起票いただく際にお客様側で事前に採取可能な <strong>Autopilot ログ</strong>についてお纏めいたします。</p><p>下記内容及び、画面ショットは 2022/9/28 時点での仕様についての記載となっております。<br>弊社ではお客様のご意見を頂戴し、日々、品質向上に努めております。その為、製品アップデートが頻繁に行われており、お客様の手元環境とは表示等が異なる可能性がございますことを、予めご承知おきくださいますようお願い致します。</p><h2 id="Autopilot-ログ"><a href="#Autopilot-ログ" class="headerlink" title="Autopilot ログ"></a>Autopilot ログ</h2><p>今回ご案内をするのは Intune チームからお客様にご案内をすることがある Autopilot ログの情報採取手順になります。<br><strong>このログ情報は、Autopilot が失敗している場合に事前採取をお願いしたい内容になります。</strong></p><p>以下の手順で事象発生デバイスの Autopilot ログを採取してご提供ください。</p><h3 id="Intune-へ登録できていない場合"><a href="#Intune-へ登録できていない場合" class="headerlink" title="[Intune へ登録できていない場合]"></a>[Intune へ登録できていない場合]</h3><p><strong>1. 該当デバイスにてエラーメッセージが表示されている画面上で Shift + F10 キーを押してコマンドプロンプトを開く</strong></p><p><img src="/blog/intune/20220913_03/autopilot_03.png"></p><p><strong>2. コマンドプロンプトから下記のコマンドを実行し、autopilot 関連の情報を採取する</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdmdiagnosticstool.exe -area Autopilot;TPM -cab C:\Temp\autopilot.cab</span><br></pre></td></tr></table></figure><p>※ 手順 2 において、コマンドが失敗する場合は</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdmdiagnosticstool.exe -area Autopilot -cab C:\Temp\autopilot.cab</span><br></pre></td></tr></table></figure><p>を実行ください。</p><p><strong>3. C:\Temp に格納されている autopilot.cab を Microsoft 社への起票時に添付する</strong></p><h3 id="Intune-へ登録できている場合"><a href="#Intune-へ登録できている場合" class="headerlink" title="[Intune へ登録できている場合]"></a>[Intune へ登録できている場合]</h3><p><strong>1. Microsoft Endpoint Manager admin center &lt; <a href="https://endpoint.microsoft.com/">https://endpoint.microsoft.com/</a> &gt; へログインし、[デバイス] &gt;  Windows] にて対象のデバイスを選択する</strong></p><p><strong>2. デバイスの [概要] ページ上部の [診断の収集] &gt; [はい] を選択すると、デバイスの [概要] ページに保留中の通知が表示される</strong></p><p><img src="/blog/intune/20220913_03/autopilot_01.png"></p><p>※ 上部に [診断の収集] が表示されていない場合は、[…] &gt; [診断の収集] のように選択ください。</p><p><strong>3. 左側の [モニター] 配下の [デバイス診断] を選択し、[ダウンロード] &gt; [はい] をクリックする</strong></p><p><img src="/blog/intune/20220913_03/autopilot_02.png"></p><p><strong>4. 採取した診断ログを Microsoft 社への起票時に添付する</strong></p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。<br>本記事、または Intune に関しましてご不明点等ございましたら、Service Request（お問い合わせ）にて Intune サポートチームの担当者にお気兼ねなくご相談ください。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームの Ishikawa です。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポート チームへお問い</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>MECM パッケージで Micorosoft Defender 定義更新ファイルを展開 ~使い方シリーズ~</title>
    <link href="https://jpmem.github.io/blog/mecm/20220908_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220908_01/</id>
    <published>2022-09-07T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.493Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>使い方シリーズ、今回はパッケージ機能を使って Microsoft Defender の定義更新ファイルを展開する手順をステップバイステップで解説致します。<br>万が一、ソフトウェア更新プログラムの機能を使って定義更新ファイルが配れない場合の暫定対処作として役立ちます。ぜひ確認してみてください。  </p><h2 id="1-定義更新ファイルのダウンロード"><a href="#1-定義更新ファイルのダウンロード" class="headerlink" title="1. 定義更新ファイルのダウンロード"></a>1. 定義更新ファイルのダウンロード</h2><p>まず最初に今回適用を行いたい定義更新ファイル（mpam-fe.exe）をダウンロードします。<br>※ ご利用の環境に合わせてダウンロードするファイルをご選択くださいますようお願い申し上げます。</p><p>　　<a href="https://www.microsoft.com/en-us/wdsi/defenderupdates">https://www.microsoft.com/en-us/wdsi/defenderupdates</a></p><p>例えば Windows 11 の Microsoft Defender の定義更新ファイルを適用したい場合には下記からダウンロードします。</p><p><img src="/blog/mecm/20220908_01/20220908_01_22.png" alt="image.png"></p><p>ダウンロードしたファイルを任意の共有フォルダーに 配置します。<br>サイト サーバー上など、サイト サーバーからアクセスできる場所であれば、どの場所でも構いません。<br>mpam-fe.exe は 32 bit 版と 64 bit 版が存在しますので、例えば以下のようなフォルダー構成でファイルを配置します。  </p><p>例) サーバー名 CM01 の共有フォルダーに配置する場合<br>　※必要に応じて、32 bit 版、64 bit 番をご用意ください。</p><ul><li>32 bit 版 mpam-fe.exe を配置するフォルダー</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\CM\CM_PackageSource\Endpoint Protection Definition Updates\i386</span><br></pre></td></tr></table></figure><ul><li>64 bit 版 mpam-feX64.exe を配置するフォルダー</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\CM\CM_PackageSource\Endpoint Protection Definition Updates\x64</span><br></pre></td></tr></table></figure><p>パッケージ配布を一定期間運用いただく場合、定期的に新しい mpam-fe.exe を入手し、上記フォルダーに上書き保存するようにします。  </p><h2 id="2-パッケージの作成"><a href="#2-パッケージの作成" class="headerlink" title="2. パッケージの作成"></a>2. パッケージの作成</h2><p>定義更新ファイルのインストールを行うパッケージを作成します。  </p><p><em><strong>2-1.</strong></em> Configuration Manager コンソールを開き、以下の場所に移動します。  </p><p>[ソフトウェア ライブラリ] - [概要] - [パッケージ]  </p><p><em><strong>2-2.</strong></em> リボン メニューの [ホーム] タブより、[作成] - [パッケージの作成] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_01.png" alt="image.png"></p><p><em><strong>2-3.</strong></em> パッケージとプログラムの作成ウィザードが開くので、[全般] ページにて、「Endpoint Protection 定義ファイル」など任意の名前を入力します。<br>　また、[このパッケージにソース ファイルを含める] のチェック ボックスをオンにして、[参照] をクリックします。  </p><p><em><strong>2-4.</strong></em> ソースフォルダーに定義ファイルの配置場所を入力し、[OK] をクリックします。<br>　上記例のとおりファイルを配置した場合は、以下のパスとなります。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\CM\CM_PackageSource\Endpoint Protection Definition Updates</span><br></pre></td></tr></table></figure><p><img src="/blog/mecm/20220908_01/20220908_01_02.png" alt="image.png"></p><p>※ x64 フォルダーや i386 フォルダーが配置されているフォルダーを選択します。  </p><p><em><strong>2-5.</strong></em> [プログラムの種類] ページにて、ここでは [プログラムを作成しない] を選択して、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_03.png" alt="image.png"></p><p><em><strong>2-6.</strong></em> [次へ] をクリックしていき、ウィザードを完了します。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_04.png" alt="image.png"></p><p><em><strong>2-7.</strong></em> Configuration Manager コンソールに作成したコレクションが表示されます。作成したパッケージを右クリックし、[プロパティ] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_05.png" alt="image.png"></p><p><em><strong>2-8.</strong></em> プロパティより、[データソース] タブにて、[スケジュールに従って配布ポイントを更新する] のチェック ボックスをオンにします。<br>パッケージ ソースに配置されている定義ファイルが更新された際は、配布ポイントの更新が必要となりますので、自動化する設定となります。<br>スケジュールは、お客様が定義ファイルを更新されるタイミングに合わせて任意のスケジュールを設定してください。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_06.png" alt="image.png"></p><h3 id="3-プログラムの作成-必要に応じて、32-bit-版も作成してください"><a href="#3-プログラムの作成-必要に応じて、32-bit-版も作成してください" class="headerlink" title="3. プログラムの作成 (必要に応じて、32 bit 版も作成してください)"></a>3. プログラムの作成 (必要に応じて、32 bit 版も作成してください)</h3><p>mpam-fe.exe を適用するためのプログラムを作成します。<br>32 bit 版と 64 bit 版を合わせて、2 つのプログラムを作成する必要があります。<br>ここでは、64 bit 版の mpam-fe.exe を適用するためのプログラムを作成する手順をご案内します。  </p><p><em><strong>3-1.</strong></em> Configuration Manager コンソールを開き、以下の場所に移動します。<br>　[ソフトウェア ライブラリ] - [概要] - [パッケージ]  </p><p><em><strong>3-2.</strong></em> 右上ペインより、<strong>手順 2. パッケージの作成</strong> で作成したパッケージを選択します。  </p><p><em><strong>3-3.</strong></em> リボン メニューの [ホーム] タブより、[プログラムの作成] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_07.png" alt="image.png"></p><p><em><strong>3-4.</strong></em> 64 bit 版の mpam-fe.exe を適用するプログラムを作成します。  </p><p>　<em><strong>3-4-1.</strong></em> [プログラムの種類] ページで [標準プログラム] を選択し、[次へ] をクリックします。  </p><p>　<em><strong>3-4-2.</strong></em> [標準プログラム] ページで、以下のように入力し [次へ] をクリックします。  </p><ul><li><p>名前 : 任意の名前 (mpam-feX64 など)  </p></li><li><p>コマンド ライン : <code>.\X64\mpam-fe.exe /q</code><br>([参照] ボタンより、64 bit 版の mpam-fe.exe を選択した上で、/q オプションを付加します。)  </p></li><li><p>プログラムの実行条件 : ユーザーのログオン状態に関係なし  </p></li><li><p>実行モード : 管理者権限で実行する (変更不可)  </p></li></ul><p><img src="/blog/mecm/20220908_01/20220908_01_08.png" alt="image.png"></p><p><em><strong>3-4-3.</strong></em> [要件] ページで、[指定したプラットフォームだけで実行可能] を選択し、配布対象となる 64 bit 版 Windows プラットフォームのチェック ボックスをオンにして、[次へ] をクリックします。  </p><p>　　※ 32 bit 版の OS を選択しないようにしてください。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_09.png" alt="image.png"></p><p><em><strong>3-4-4.</strong></em> [次へ] をクリックしていき、ウィザードを完了します。<br>64 bit 版のプログラムの作成手順は以上となります。<br>32 bit 版も管理対象に含める場合は、同様の手順でプログラムを作成してください。  </p><h3 id="4-展開の作成"><a href="#4-展開の作成" class="headerlink" title="4. 展開の作成"></a>4. 展開の作成</h3><p>展開を作成して、管理対象コンピューターに定期的に定義ファイルを配布します。</p><p><em><strong>4-1.</strong></em> Configuration Manager コンソールを開き、以下の場所に移動します。<br>　[ソフトウェア ライブラリ] - [概要] - [パッケージ]  </p><p><em><strong>4-2.</strong></em> 右上ペインより、手順 C. で作成したパッケージを選択します。  </p><p><em><strong>4-3.</strong></em> リボン メニューの [ホーム] タブより、[展開] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_10.png" alt="image.png"></p><p><em><strong>4-4.</strong></em> ソフトウェアの展開ウィザードが開くので、[全般] ページにて、以下のように設定して [次へ] をクリックします。  </p><ul><li>ソフトウェア : mpam-feX64 (<strong>手順 3. プログラムの作成</strong> で作成した 64 bit 版 mpam-feX64.exe のプログラム)  </li><li>コレクション : Endpoint Protection 定義ファイルを展開したいコレクション</li></ul><p><img src="/blog/mecm/20220908_01/20220908_01_11.png" alt="image.png"></p><p><em><strong>4-5.</strong></em> [コンテンツ] ページにて、クライアントがアクセス可能な配布ポイントを追加して、[次へ] をクリックします。  </p><p><em><strong>4-6.</strong></em> [展開設定] ページにて、以下の設定をして、[次へ] をクリックします。  </p><ul><li>操作 : インストール  </li><li>目的 : 必須  </li></ul><p><img src="/blog/mecm/20220908_01/20220908_01_12.png" alt="image.png"></p><p><em><strong>4-7.</strong></em> [スケジュール] ページにて、[新規] をクリックして、スケジュールを決定します。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_13.png" alt="image.png"></p><p><em><strong>4-7-1.</strong></em> 割り当てスケジュールが開くので、[スケジュール] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_14.png" alt="image.png"></p><p><em><strong>4-7-2.</strong></em> カスタム スケジュールが開くので、定期的にプログラムを実行するために、繰り返しパターンを設定します。  </p><p>一日単位で定義ファイルを更新する場合は、[間隔指定] を選択して、間隔に「1 日間」を指定し、[OK] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_15.png" alt="image.png"></p><p><em><strong>4-7-3.</strong></em> [OK] をクリックして、ダイアログを閉じます。  </p><p><em><strong>4-8.</strong></em> [スケジュール] ページにて、再実行の動作に [プログラムを常に再実行する] を選択して、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_16.png" alt="image.png"></p><p><em><strong>4-9.</strong></em> [ユーザー側の表示と操作] ページにて、既定の設定のまま [次へ] をクリックします。  </p><p><em><strong>4-10.</strong></em> [配布ポイント] ページにて、既定の設定のまま [次へ] をクリックします。  </p><p><em><strong>4-11.</strong></em> [次へ] をクリックしていき、ウィザードを完了します。    </p><p>64 bit 版の展開の作成手順は以上となります。<br>32 bit 版も管理対象に含める場合は、同様の手順で展開を作成してください。  </p><p>※パッケージの再実行の動作については <a href="https://jpmem.github.io/blog/mecm/20220421_01/">こちら</a>で解説しております。  </p><h3 id="5-コンテンツの配布完了を確認する"><a href="#5-コンテンツの配布完了を確認する" class="headerlink" title="5. コンテンツの配布完了を確認する"></a>5. コンテンツの配布完了を確認する</h3><p>パッケージ ソースから配布ポイントへのコンテンツの配布が完了したことを確認します。  </p><p><em><strong>5-1.</strong></em> Configuration Manager コンソールを開き、以下の場所に移動します。  </p><p>[ソフトウェア ライブラリ] - [概要] - [パッケージ]  </p><p><em><strong>5-2.</strong></em> 右上ペインより、<strong>手順 3. プログラムの作成</strong> で作成したパッケージを選択します。  </p><p><em><strong>5-3.</strong></em> リボン メニューの [ホーム] タブより、[最新の情報に更新] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_18.png" alt="image.png"></p><p><em><strong>5-4.</strong></em> 右下ペインの [概要] タブにて、[コンテンツのステータス] が「成功」(<font color="MediumSeaGreen">緑色</font>) になっていることを確認します。  </p><p>※「進行中」(<font color="Khaki">黄色</font>) で表示される場合、配布が進行中なので、しばらく待って再度「最新情報に更新」をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_17.png" alt="image.png"></p><h3 id="6-定義ファイルが適用できるか確認する"><a href="#6-定義ファイルが適用できるか確認する" class="headerlink" title="6. 定義ファイルが適用できるか確認する"></a>6. 定義ファイルが適用できるか確認する</h3><p>上記手順実施後、クライアントでコンピューター ポリシーが取得されると、定義ファイルのダウンロードおよびインストールが行われます。<br>コンピューター ポリシーの取得は、既定では 1 時間に 1 回の間隔で実行されますが、手動で実行することもできます。<br>確認手順は、以下のとおりとなります。  </p><p><em><strong>6-1.</strong></em> 展開対象となっているコンピューターのコントロール パネルを開き、Configuration Manager を開きます。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_19.png" alt="image.png"></p><p><em><strong>6-2.</strong></em> [操作] タブより、[コンピューター ポリシーの取得および評価サイクル] を選択し、[直ちに実行] をクリックします。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_20.png" alt="image.png"></p><p>上記手順実行後に、コンピューター ポリシーの取得が開始されます。その後、定義ファイルがダウンロードされ、更新されます。  </p><p>クライアント端末側で [スタート] &gt; Windows セキュリティを開き、[ウイルスと脅威の防止の更新] の [ウイルスと驚異の防止の更新] の [前回の更新] が直近の日時になっており、定義のバージョンが更新されていれば、インストールは正常に完了しています。<br>バージョンは [Windows セキュリティ] &gt; [設定(画面左下歯車アイコン)] &gt; [バージョン情報] にてご確認いただけます。  </p><p><img src="/blog/mecm/20220908_01/20220908_01_21.png" alt="image.png"></p><p>なお、コンピューター ポリシーの取得には時間がかかる場合がありますので、正常に完了しない場合は、何度か <em><strong>6-2.</strong></em> の手順を実行してください。  </p><h3 id="7-定義ファイル更新の際の配布手順"><a href="#7-定義ファイル更新の際の配布手順" class="headerlink" title="7. 定義ファイル更新の際の配布手順"></a>7. 定義ファイル更新の際の配布手順</h3><p>新しい定義ファイルに更新する際には、以下の手順を実行します。  </p><p><em><strong>7-1.</strong></em> 手順 <strong>1. 定義更新ファイルのダウンロード</strong> で配置した定義ファイルを、新しい定義ファイルで上書きします。  </p><p><em><strong>7-2.</strong></em> 手順 <strong>2-8.</strong> で指定したスケジュールに従って、配布ポイントのコンテンツが更新されます。<br>今すぐに配布ポイントのコンテンツを更新したい場合は、以下を実行します。  </p><p><em><strong>7-2-1.</strong></em> Configuration Manager コンソールを開き、以下の場所に移動します。  </p><p>[ソフトウェア ライブラリ] - [概要] - [パッケージ]  </p><p><em><strong>7-2-2.</strong></em> 右上ペインより、手順 <strong>2. パッケージの作成</strong> で作成したパッケージを選択します。  </p><p><em><strong>7-2-3.</strong></em> 右クリック メニューから、[配布ポイントの更新] を選択します。  </p><p><em><strong>7-2-4.</strong></em> 配布ポイントのコンテンツが更新されます。  </p><p>配布の完了ステータスの確認方法は、前述の手順 <strong>5. コンテンツの配布完了を確認する</strong> を参照してください。  </p><p><em><strong>7-3.</strong></em> 手順 <strong>4. 展開の作成</strong> で指定したカスタム スケジュールに従って、パッケージが展開されます。  </p><p><em><strong>7-4.</strong></em> クライアントが [コンピューター ポリシーの取得および評価サイクル] を実行した際に、パッケージがダウンロードされ、定義ファイルが更新されます。<br>既定では、 [コンピューター ポリシーの取得および評価サイクル] は60 分ごとに実行されます。</p><p>定義ファイル配布の手順は以上となります。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;使い方シリーズ、今回はパッケージ機能を使って Microsoft Defender の定義更新ファイルを展開する手順をステップバイステップで解説致します。&lt;br&gt;万が</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
    <category term="使い方" scheme="https://jpmem.github.io/blog/tags/%E4%BD%BF%E3%81%84%E6%96%B9/"/>
    
  </entry>
  
  <entry>
    <title>プロビジョニングが開始されない場合に確認するポイント</title>
    <link href="https://jpmem.github.io/blog/w365/2022-09-06_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-09-06_01/</id>
    <published>2022-09-05T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.541Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポートです。<br>本日は、ユーザーに Windows 365 Enterprise のライセンスを付与したのに、プロビジョニングが開始されない場合にご確認いただきたい点についてご紹介させていただきます。  </p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/9/6 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="1-必要なライセンスが付与されているか"><a href="#1-必要なライセンスが付与されているか" class="headerlink" title="1. 必要なライセンスが付与されているか"></a>1. 必要なライセンスが付与されているか</h3><p>Windows 365 Enterprise のライセンスの他に、Intune や Windows、Azure AD のライセンスが必要です。<br><a href="https://docs.microsoft.com/ja-jp/windows-365/enterprise/requirements#licensing-requirements">ライセンスの要件</a>  </p><p>該当のユーザーに、これらのライセンスが付与されているかご確認ください。  </p><h3 id="2-プロビジョニング-ポリシーが割り当てているグループに所属しているか"><a href="#2-プロビジョニング-ポリシーが割り当てているグループに所属しているか" class="headerlink" title="2. プロビジョニング ポリシーが割り当てているグループに所属しているか"></a>2. プロビジョニング ポリシーが割り当てているグループに所属しているか</h3><p>案外見落としがちです。<br>プロビジョニング ポリシーを作成するときに、ポリシーを割り当てるグループを指定しますが、該当のユーザーがそのグループに所属していない場合、プロビジョニングは開始されません。<br>必要なライセンスを付与しているにもかかわらず、以下のように “未プロビジョニング” と表示されている場合、上記に該当します。  </p><p><img src="/blog/w365/2022-09-06_01/2022-09-06-18-06-57.png">  </p><p>この場合は、該当のユーザーをプロビジョニング ポリシーで指定しているグループに所属させることでプロビジョニングが開始されますので、お試しください。  </p><p>以上、プロビジョニングが開始されない場合にご確認いただきたい点のご紹介でした。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポートです。&lt;br&gt;本日は、ユーザーに Windows 365 Enterprise のライセンスを付与したのに、プロビジョニングが開始されない場合にご確認いただきたい点についてご紹介させていただ</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>クラウド PC に接続できない場合の対処方法について</title>
    <link href="https://jpmem.github.io/blog/w365/2022-08-09_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-08-09_01/</id>
    <published>2022-08-08T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.541Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田 です。<br>本日は、ブラウザ経由やリモート デスクトップ アプリからクラウド PC に接続ができない場合の対処方法をいくつかご紹介させていただきます。</p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/8/9 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="1-再起動を実施"><a href="#1-再起動を実施" class="headerlink" title="1. 再起動を実施"></a>1. 再起動を実施</h3><p>以下の画面からクラウド PC を再起動することにより、接続が行なえるようになる可能性がございますので、お試しください。  </p><p>■Microsoft Endpoint Manager から  </p><p><img src="/blog/w365/2022-08-09_01/2022-08-09-14-02-07.png">  </p><p>■Windows 365 ポータル画面から  </p><p><img src="/blog/w365/2022-08-09_01/2022-08-09-14-27-08.png">  </p><h3 id="2-再プロビジョニングを実施"><a href="#2-再プロビジョニングを実施" class="headerlink" title="2. 再プロビジョニングを実施"></a>2. 再プロビジョニングを実施</h3><p>再起動で改善がない場合、クラウド PC を再プロビジョニングすることにより、接続が行なえるようになる可能性がございますので、お試しください。  </p><p>■Microsoft Endpoint Manager から  </p><p><img src="/blog/w365/2022-08-09_01/2022-08-09-15-17-32.png">  </p><h3 id="3-多要素認証の設定について"><a href="#3-多要素認証の設定について" class="headerlink" title="3. 多要素認証の設定について"></a>3. 多要素認証の設定について</h3><p>Microsoft 管理センターで多要素認証が有効になっている場合、クラウド PC への接続に失敗するため、以下をご確認ください。  </p><ol><li>Microsoft 管理センターにサインインします。<br><a href="https://admin.microsoft.com/Adminportal/Home">https://admin.microsoft.com/Adminportal/Home</a>  </li><li>[設定] - [組織設定] を選択し、[多要素認証] - [多要素認証を構成する] を選択します。  </li><li>表示された画面で、該当のユーザーの MULTI-FACTOR AUTHENTICATION の状態を確認します。  </li><li>[有効] になっている場合は、[無効] に設定の上、クラウド PC に接続できるか確認します。<br><img src="/blog/w365/2022-08-09_01/2022-08-09-15-36-30.png">  </li></ol><p>上記 3 点を実施後もクラウド PC への接続ができない場合、調査が必要でございますので、弊社サポートへのお問い合わせをご検討いただけますと幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田 です。&lt;br&gt;本日は、ブラウザ経由やリモート デスクトップ アプリからクラウド PC に接続ができない場合の対処方法をいくつかご紹介させていただきます。&lt;/p&gt;
&lt;h2 id=&quot;免責</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>ハードウェア インベントリで HKLM 配下の特定のレジストリを収集する ～使い方シリーズ～</title>
    <link href="https://jpmem.github.io/blog/mecm/20220722_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220722_01/</id>
    <published>2022-07-21T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.493Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>使い方シリーズ、今回はハードウェア インベントリで HKLM 配下の特定のレジストリを収集する方法についてご案内いたします。<br>特定のレジストリ値を収集して、管理コンソールやレポートで確認したいという場合に本手順をお役立ていただけますと幸いです。</p><h1 id="想定シナリオ"><a href="#想定シナリオ" class="headerlink" title="想定シナリオ"></a>想定シナリオ</h1><p>以下のレジストリ値を収集して、値が 2 のデバイスを抽出することを目的とします。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">キー：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</span><br><span class="line">値  ：DisableIPSourceRouting (REG_DWORD)</span><br></pre></td></tr></table></figure><p>他のレジストリ値についても、mof ファイルをレジストリ値に応じてカスタマイズすることで収集可能ですのでお試しください。</p><h1 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h1><p>以下の流れで手順を進めていきます。</p><ol><li>MOF ファイルを作成する</li><li>インベントリの収集対象に追加する</li></ol><h2 id="1-MOF-ファイルを作成する"><a href="#1-MOF-ファイルを作成する" class="headerlink" title="1. MOF ファイルを作成する"></a>1. MOF ファイルを作成する</h2><p>まずはテスト端末で手順をお試しください。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">キー：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</span><br><span class="line">値  ：DisableIPSourceRouting (REG_DWORD)</span><br></pre></td></tr></table></figure><ol><li>取得したいレジストリ値の MOF ファイルを作成します。<br>configuration.mof 追記用とインポート用の 2 つの MOF ファイルが必要となります。<br>例えば、今回収集対象とするレジストリ値の場合は以下の通りです。</li></ol><ul><li><p>configuration.mof</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#pragma namespace (&quot;\\\\.\\root\\cimv2&quot;)</span><br><span class="line">#pragma deleteclass(&quot;TcpipParametersInfo&quot;, NOFAIL)</span><br><span class="line">[DYNPROPS]</span><br><span class="line">Class TcpipParametersInfo</span><br><span class="line">&#123;</span><br><span class="line">[key] string KeyName;</span><br><span class="line">Uint32 DisableIPSourceRouting;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[DYNPROPS]</span><br><span class="line">Instance of TcpipParametersInfo</span><br><span class="line">&#123;</span><br><span class="line">KeyName=&quot;Value&quot;;</span><br><span class="line">[PropertyContext(&quot;Local|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters|DisableIPSourceRouting&quot;),Dynamic,Provider(&quot;RegPropProv&quot;)] DisableIPSourceRouting;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>importclass.mof</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#pragma namespace (&quot;\\\\.\\root\\cimv2&quot;)</span><br><span class="line">#pragma deleteclass(&quot;TcpipParametersInfo&quot;, NOFAIL)</span><br><span class="line">[SMS_Report(TRUE),SMS_Group_Name(&quot;TcpipParametersInfo&quot;),SMS_Class_ID(&quot;TcpipParametersInfo&quot;)]</span><br><span class="line">Class TcpipParametersInfo: SMS_Class_Template</span><br><span class="line">&#123;</span><br><span class="line">[SMS_Report(TRUE),key] string KeyName;</span><br><span class="line">[SMS_Report(TRUE)] Uint32 DisableIPSourceRouting;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul><p>上記 MOF ファイル内の「TcpipParametersInfo」の部分は任意の名前で構いません。<br><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters</code> の部分は収集対象にしたいレジストリ キーになります。<br><code>DisableIPSourceRouting</code> の部分は収集対象にしたいレジストリ値になります。</p><p>準備ができた後、検証用のコンピューターでコマンド プロンプトから MOF ファイルのあるパスに移動し、以下のコマンドを実行します。</p><p><code>mofcomp -check xxxx.mof</code>　<br>（xxxx にはmof につけたファイル名を入れてください）</p><p>構文チェックでエラーが出力されないことを確認しましょう。</p><h2 id="2-インベントリの収集対象に追加する"><a href="#2-インベントリの収集対象に追加する" class="headerlink" title="2. インベントリの収集対象に追加する"></a>2. インベントリの収集対象に追加する</h2><ol><li>最上位の Configuration Manager サイト サーバー (中央管理サイト、及びスタンドアロン プライマリ サイト) にて、以下のファイルをバックアップしておきます。</li></ol><p><code>\Program Files\Microsoft Configuration Manager\inboxes\clifiles.src\hinv\configuration.mof</code><br>※ \Program Files\Microsoft Configuration Manager は Configuration Manager サイトのインストール先に応じて変更されます。</p><ol start="2"><li><p>configuration.mof をメモ帳で開き、手順 1. で作成した configuration.mof 追記用 MOF ファイルの内容を一番下に追記して保存します。具体的には、ファイル末尾の “Added extensions start/ end” の 2 行の間に挿入します。</p></li><li><p>上記作業により、SMS_EXECUTIVE サービスがまもなくファイルの変更を検知し、追加内容をクライアントへのポリシーに変換します。</p></li><li><p>最上位のサイト サーバーにて、Configuration Manager コンソールを起動し、[管理] - [クライアント設定] を開きます。</p></li><li><p>右上ペインに表示された [既定のクライアント設定] を右クリックして、プロパティを開きます。</p></li><li><p>[既定の設定] 画面のハードウェア インベントリを開き、[クラスの設定] をクリックします。</p></li><li><p>[インポート] ボタンをクリックして、手順 1. で作成したインポート用 MOF ファイルをインポートします。</p></li><li><p>追加されたクラスのチェック ボックスをオンにして、[OK] をクリックします。</p></li><li><p>動作確認のため、サイト管理下にある Configuration Manager クライアントが動作しているテスト マシンにおいて、コントロールパネルから Configuration Manager を開いて、以下のサイクルを順番に実行します。</p></li></ol><ul><li>[コンピューターポリシーの取得および評価サイクル]  </li><li>[ハードウェア インベントリ サイクル]</li></ul><p>反映されたポリシーを受信するまでに時間がかかる場合がありますので、テストの際は上記サイクルを何度か実行ください。</p><p>拡張したハードウェアインベントリが正常に収集されると、Configuration Manager コンソールから対象マシンを右クリックして、リソース エクスプローラを起動することで、収集したレジストリ情報をご確認いただけます。</p><p>また、収集したレジストリ情報は、サイト データベースに存在するv_GS_&lt;クラス名&gt;0 ビューより参照することができます。<br>(上記例ではクラス名が TcpipParametersInfo でしたので、ビュー名は v_GS_TcpipParametersInfo0 となります。)</p><h1 id="収集したレジストリ値が、サーバー側に反映されるタイミングについて"><a href="#収集したレジストリ値が、サーバー側に反映されるタイミングについて" class="headerlink" title="収集したレジストリ値が、サーバー側に反映されるタイミングについて"></a>収集したレジストリ値が、サーバー側に反映されるタイミングについて</h1><p>MOF ファイルで定義したレジストリ値は、ハードウェア インベントリ データの 1 つとして収集されます。<br>データがサイト サーバーに送信され、正常に処理が完了した時点で、データベースに格納されます。<br>また、クライアントは、サイト サーバーで設定されたスケジュールに従って、それぞれインベントリを収集します。  </p><p>インベントリの実行間隔は、既定では 7 日毎に実行されるように設定されておりますので、クライアントに設定されたレジストリ値が、把握できるようになるまで、時間差が生じる可能性がございます。<br>実行間隔はクライアント設定で変更可能ですが、頻繁にインベントリ収集が行われるように設定した場合、ネットワーク トラフィックの増加、及びデータを処理するサイト サーバーの CPU 負荷の上昇といった現象が発生する場合もございます。<br>そのため、実行間隔の設定値については、クライアント台数やサイト サーバーの処理能力、ネットワーク環境を踏まえた上で、ご検討ください。</p><h1 id="結果を確認する方法"><a href="#結果を確認する方法" class="headerlink" title="結果を確認する方法"></a>結果を確認する方法</h1><p>収集されたレジストリ値については、以下の 2 つの方法で確認できます。</p><ol><li>データベースに SQL を発行して確認する</li><li>コレクションを作成して確認する</li></ol><h2 id="1-データベースに-SQL-を発行して確認する"><a href="#1-データベースに-SQL-を発行して確認する" class="headerlink" title="1. データベースに SQL を発行して確認する"></a>1. データベースに SQL を発行して確認する</h2><p>収集したレジストリは、サイト データベースに格納されます。<br>今回収集したレジストリ値は、v_GS_TcpipParametersInfo0 より参照できますので、以下の SQL で出力された結果より、DisableIPSourceRouting が 2 のデバイスが確認できます。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> b.Name0,a.DisableIPSourceRouting0 <span class="keyword">from</span> v_GS_TcpipParametersInfo0 a <span class="keyword">join</span> v_R_System b <span class="keyword">on</span> a.ResourceID<span class="operator">=</span>b.ResourceID</span><br><span class="line"><span class="keyword">where</span> a.DisableIPSourceRouting0<span class="operator">=</span><span class="number">2</span>  </span><br></pre></td></tr></table></figure><p>SQL の実行方法については、以下の記事をご参照ください。</p><p>Title: SQL Query 結果の出力方法について<br>URL: <a href="https://jpmem.github.io/memlog/configmgr/sql/sqlquery.html">https://jpmem.github.io/memlog/configmgr/sql/sqlquery.html</a>  </p><h2 id="2-コレクションを作成して確認する"><a href="#2-コレクションを作成して確認する" class="headerlink" title="2. コレクションを作成して確認する"></a>2. コレクションを作成して確認する</h2><p>収集したレジストリ値をもとに、DisableIPSourceRouting が 2 のデバイスのみが所属するコレクションを作成します。</p><ol><li><p>Configuration Manager コンソールを起動し、[資産とコンプライアンス] - [デバイス コレクション] を開きます。</p></li><li><p>[デバイス コレクション] を右クリックし、[デバイス コレクションの作成] を選択します。</p></li><li><p>[デバイス コレクションの作成] ウィザードが起動します。</p></li><li><p>[全般] にて、次の設定を行います。  </p></li></ol><ul><li>[名前] フィールドに任意のコレクション名を記入します。</li><li>[限定コレクション] の [参照] ボタンをクリックし、対象のコレクション（例：”すべてのシステム”）を選択します。</li></ul><ol start="5"><li>[メンバーシップの規則] にて以下の設定を行います。</li></ol><ul><li>[規則の追加] - [クエリ規則] を選択します。</li><li>[クエリ規則のプロパティ] の設定で、以下の設定を行います。<ul><li>[名前] フィールドに適宜名前を入力します。</li><li>[クエリ ステートメントの編集] をクリックします。</li></ul></li><li>クエリ ステートメントのプロパティが開きます。<ul><li>[条件] タブを選択し、黄色いボタンをクリックします。</li><li>[条件プロパティ] が開きますので、以下のように条件指定して [OK] をクリックします。クエリ ステートメントのプロパティに戻り [OK] をクリックしてクエリのプロパティ画面をすべて閉じます。</li></ul></li></ul><p>&lt;DisableIPSourceRouting が 2 のデバイス 抽出用の条件&gt;  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">条件の種類：    単純な値</span><br><span class="line">属性クラス：    TcpipParametersInfo</span><br><span class="line">属性    ：      DisableIPSourceRouting</span><br><span class="line">演算子  ：      が次の値に等しい</span><br><span class="line">値      ：      2</span><br></pre></td></tr></table></figure><ol start="6"><li><p>[次へ] をクリックして、ウィザードを進め、デバイス コレクションの作成ウィザードを終了します。</p></li><li><p>[デバイス コレクション] 画面にて作成したコレクションを右クリックして [メンバーシップの更新] を実行します。</p></li><li><p>作成したコレクションを右クリックして [メンバーの表示] を実行します。</p></li></ol><p>コレクション作成後、DisableIPSourceRouting のインベントリを送信した端末の中で、その値が 2 のデバイスが作成したコレクションに表示されていきますので、経過をご確認ください。<br>最終的に、意図する端末がコレクション上に表示されているかどうかをご確認ください。</p><p>※ コレクション作成の注意点<br>本手順にて利用しているクエリは、ハードウェア インベントリによって収集するように構成したレジストリ値を参照しています。</p><p>期待通りのクエリ結果とならない場合は、リソース エクスプローラを利用してハードウェア インベントリの収集状況およびレジストリの値をご確認ください。</p><p>Title: Configuration Manager でリソース エクスプローラーを使用してハードウェア インベントリを表示する方法<br>URL: <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/manage/inventory/use-resource-explorer-to-view-hardware-inventory">https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/manage/inventory/use-resource-explorer-to-view-hardware-inventory</a></p><p>[ハードウェア] - [ワークステーションのステータス] で、最後にクライアントのハードウェア インベントリがレポートされた時間を確認します。<br>次に [ハードウェア] - [TcpipParametersInfo] で “DisableIPSourceRouting” の値を確認します。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;使い方シリーズ、今回はハードウェア インベントリで HKLM 配下の特定のレジストリを収集する方法についてご案内いたします。&lt;br&gt;特定のレジストリ値を収集して、管理</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
    <category term="使い方" scheme="https://jpmem.github.io/blog/tags/%E4%BD%BF%E3%81%84%E6%96%B9/"/>
    
  </entry>
  
  <entry>
    <title>MECM 管理コンソールでレポートが実行できない事象について</title>
    <link href="https://jpmem.github.io/blog/mecm/20220721_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220721_01/</id>
    <published>2022-07-20T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.493Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>今回は MECM 管理コンソールでレポートが実行できない事象についてご案内いたします。 </p><h1 id="事象"><a href="#事象" class="headerlink" title="事象"></a>事象</h1><p>MECM コンソールをインストールしたマシンにおいて、Microsoft ReportViewer 2010 SP1 Redistributable をアンインストールした場合、MECM 管理コンソールより、レポートを実行しても実行できない事象が発生します。<br>この事象が発生した場合、以下のログが記録されます。</p><p><code>&lt;MECM コンソール インストール フォルダー&gt;\AdminConsole\AdminUILog\SmsAdminUI.log</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">System.IO.FileNotFoundException</span><br><span class="line">Could not load file or assembly &#x27;Microsoft.ReportViewer.WinForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&#x27; or one of its dependencies. The system cannot find the file specified.</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.ReportViewerWindowsForms..ctor()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportFormViewControl.InitializeComponent()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportFormViewControl..ctor()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportDialog.InitializeReportControl()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportDialog..ctor(Tag tag)</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.Actions.ShowReport(IReport report, IReportServer reportServer, IResultObject resultObject)</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.Actions.LaunchReport(Object formView, ScopeNode scopeNode, ActionDescription actionDescription, IResultObject resultObject, PropertyDataUpdated propertyDataUpdated, Status status)</span><br></pre></td></tr></table></figure><h1 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h1><p>MECM 管理コンソールのレポート ビューアーではレポートを表示する際に、内部的に ReportViewer ランタイムを使用しています。<br>そのため、Microsoft ReportViewer 2010 SP1 Redistributable をアンインストールすると、MECM 管理コンソールのレポート ビューアーを使用して、レポートを表示できなくなります。</p><h1 id="回避策"><a href="#回避策" class="headerlink" title="回避策"></a>回避策</h1><p>MECM のレポート機能は、MECM 管理コンソールのレポート ビューアーで表示する方法と、ブラウザから表示可能な Web ベースのレポートを表示する方法が公式にサポートされております。</p><p>Title: Configuration Manager でのレポートの概要 - SQL Server Reporting Services<br>URL: <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/servers/manage/introduction-to-reporting#sql-server-reporting-services">https://docs.microsoft.com/ja-jp/mem/configmgr/core/servers/manage/introduction-to-reporting#sql-server-reporting-services</a>  </p><blockquote><p>Configuration Manager レポート ビューアーを使用するか、レポートへの Web ベースの接続であるレポート マネージャーを使用してレポートを表示します。</p></blockquote><p>ReportViewer をアンインストールしたマシンであっても、管理コンソールより対象レポートを選択し [ブラウザーで実行] をクリックすることで、ブラウザよりレポートを実行できます。<br>Microsoft ReportViewer 2010 SP1 Redistributable をアンインストールしており、コンソールからレポートが実行できない場合は、[ブラウザーで実行] をクリックする方法をご利用くださいますようお願いいたします。</p><p><img src="/blog/mecm/20220721_01/1.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;今回は MECM 管理コンソールでレポートが実行できない事象についてご案内いたします。 &lt;/p&gt;
&lt;h1 id=&quot;事象&quot;&gt;&lt;a href=&quot;#事象&quot; class=&quot;h</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>Configuration Manager から更新プログラムを配信する際の再起動通知の動作について (2022 新版)</title>
    <link href="https://jpmem.github.io/blog/mecm/20220714_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220714_01/</id>
    <published>2022-07-13T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.489Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チーム青木です。<br>本記事では、Configuration Manager から更新プログラム配信時の再起動動作についてご紹介いたします。また、本記事は以下の記事の新版となります。  </p><p>Title : Configuration Manager から更新プログラムを配信する際の再起動動作について<br>URL : <a href="https://jpmem.github.io/blog/mecm/20180719_01/">https://jpmem.github.io/blog/mecm/20180719_01/</a>  </p><p>Configuration Manager から更新プログラムを展開する際に、Configuration Manager で再起動を抑制させる/再起動させる設定のお役立て情報おまとめいたしました。また、新版では再起動通知の動作についてもご紹介しております。   </p><h2 id="再起動を抑制する場合"><a href="#再起動を抑制する場合" class="headerlink" title="再起動を抑制する場合"></a>再起動を抑制する場合</h2><p>展開設定時に [デバイスの再起動] - [サーバー(サーバーOSの場合) or ワークステーション(クライアントOSの場合)]　にチェックを入れることで、再起動の抑制をすることが可能です。</p><p><img src="/blog/mecm/20220714_01/1.png" alt="image.png"></p><p>上記設定値を入れることで以下のポップアップとなります。</p><p><img src="/blog/mecm/20220714_01/2.png" alt="image.png"></p><h2 id="再起動をさせる場合"><a href="#再起動をさせる場合" class="headerlink" title="再起動をさせる場合"></a>再起動をさせる場合</h2><p>展開設定時に [デバイスの再起動] - [サーバー(サーバーOSの場合) or ワークステーション(クライアントOSの場合)]　のチェックを無効にすることで、強制的に再起動させることが可能です。  </p><p><img src="/blog/mecm/20220714_01/3.png" alt="image.png"></p><h2 id="再起動通知を制御するクライアント設定について"><a href="#再起動通知を制御するクライアント設定について" class="headerlink" title="再起動通知を制御するクライアント設定について"></a>再起動通知を制御するクライアント設定について</h2><p>Configuration Manager コンソールから、クライアント設定を設定することで再起動時の通知の動作を制御出来ます。<br>以下に具体的な設定とその動作をご紹介いたします。再起動が必要な旨をユーザーに通知させたい管理者の方々のご参考になりましたら幸いです。  </p><h3 id="lt-再起動通知の動作-gt"><a href="#lt-再起動通知の動作-gt" class="headerlink" title="&lt;再起動通知の動作&gt;"></a>&lt;再起動通知の動作&gt;</h3><p>Configuration Manager コンソールにて、クライアント設定の “コンピューターの再起動” タブで下記項目を “はい” に設定いただきますと、再起動を促すダイアログ通知をクライアントに表示させることができます。<br>下記項目を “いいえ” に設定するとトースト通知をクライアントに表示させることができます。これらの 2 種類の通知を、お好みによってお使い分けていただければと思います。</p><ul><li>該当のクライアント設定 (既定値は “いいえ” の為、”はい” に設定する必要が有ります。)  <pre><code>展開で再起動が必要な場合、トースト通知ではなくダイアログ ウインドウをユーザーに表示する  </code></pre></li></ul><p>▼ クライアント設定 サンプル画像 (既定値)<br><img src="/blog/mecm/20220714_01/4.png" alt="image.png">  </p><p>▼ ダイアログ通知 サンプル画像<br><img src="/blog/mecm/20220714_01/5.png" alt="image.png">  </p><p>なお、ダイアログ通知のタイミングにつきましては、下記 2 つのタイミングで行われます。  </p><ol><li>クライアントに再起動が必要な更新プログラムがインストールされた直後のタイミング  </li><li>クライアント設定の “期限後にユーザーへの再起動リマインダー通知の頻度を指定する” で設定した、リマインダー通知のタイミング<br>(リマインダー通知のタイミングとは、ダイアログ通知で “再通知” をクリックした後、次のダイアログ通知が表示される際のタイミング)  </li></ol><p>通知機能の詳細につきましては、以下の公開情報に記載されております為、こちらもご参考になりましたら幸いでございます。  </p><p>Title : Configuration Managerのデバイス再起動通知<br>URL : <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/deploy/device-restart-notifications">https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/deploy/device-restart-notifications</a></p><h2 id="実際の再起動通知の動作画面をご紹介します"><a href="#実際の再起動通知の動作画面をご紹介します" class="headerlink" title="実際の再起動通知の動作画面をご紹介します"></a>実際の再起動通知の動作画面をご紹介します</h2><p>下記の内容のクライアント設定を適用し、ダイアログ通知が行われるタイミングを検証いたしました為以下に併せてご案内いたします。ぜひ貴社ご運用のご参考になりましたら幸いでございます。  </p><p>▼ 検証の為に設定したクライアント設定<br><img src="/blog/mecm/20220714_01/6.png" alt="image.png">  </p><p>&lt;検証&gt;</p><ol><li><p>クライアントにて MECM から展開した更新プログラムのダウンロードが完了すると、以下の 2 つのトースト通知が行われた。<br><img src="/blog/mecm/20220714_01/7.png" alt="image.png">  </p></li><li><p>更新プログラムのインストール後に再起動を要する場合、直ぐに以下のダイアログ通知が行われた。<br>ダイアログ通知に表示されている “コンピューターが自動的に再起動するまでの残り時間” は、クライアント設定の “期限後からデバイスが再起動されるまでの経過時間を指定します” で設定した 10 分が反映している。<br><img src="/blog/mecm/20220714_01/8.png" alt="image.png">  </p></li><li><p>「2.」のダイアログ通知で “再通知” をクリックした場合、ダイアログ通知が一旦消え、2 分後に再度ダイアログ通知が行われた。<br>クライアント設定の “期限後にユーザーへの再起動リマインダー通知の頻度を指定する” で設定した 2 分が反映している。<br><img src="/blog/mecm/20220714_01/9.png" alt="image.png">  </p></li><li><p>リマインダー通知が行われたタイミングで、再起動までの時間が、クライアント設定の “デバイスが再起動されるまでの最終カウントダウン通知をユーザーに表示する時間を指定します” で設定した 5 分以内になった為、”再通知” がグレーアウトして押せなくなった。また、×をクリックしてもダイアログ通知が消えなくなった。<br><img src="/blog/mecm/20220714_01/10.png" alt="image.png"> </p></li></ol><p>上記のように、リマインダー通知のタイミングを制御する事で、どのくらいの頻度でユーザーへ通知を出すのか等の運用を決めることが出来る為、本記事をご参考にしていただきつつ会社の運用に併せて設定値を決めていただければと思います。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チーム青木です。&lt;br&gt;本記事では、Configuration Manager から更新プログラム配信時の再起動動作についてご紹介いたします。また、本記事は以下の記事の新版となります。  &lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Endpoint Configuration Manager におけるピアキャッシュ機能について - その 2 (動作編)</title>
    <link href="https://jpmem.github.io/blog/mecm/20220713_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220713_01/</id>
    <published>2022-07-12T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.489Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チーム青木です。  </p><p>MECM からのコンテンツの配布の際に、ネットワークの負荷を軽減できるピアキャッシュ機能は実際にどのような動作となっているのか、ログの抜粋と共にご紹介させていただきます。<br>本ブログは以下ブログのシリーズ第 2 弾です。ピアキャッシュの概要については以下ブログをご参考にしてくださいませ。  </p><p>Title : System Center Configuration Manager における BranchCache、ピアキャッシュ機能について - その 1 (概要編)<br>URL : <a href="https://jpmem.github.io/blog/mecm/20180911_01/">https://jpmem.github.io/blog/mecm/20180911_01/</a>  </p><h2 id="ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説"><a href="#ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説" class="headerlink" title="ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説"></a>ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説</h2><p>ピアキャッシュが有効の場合のログを抜粋し、実際にどのような動作が行われるのかを解説します。  </p><p>ピアキャッシュを有効にしている場合に、ピアキャッシュ クライアントがコンテンツを取得する際の動作は C\Windows\CCM\Logs\ContentTransferManager.log に記述されます。  </p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:57.986    ContentTransferManager    8316 (0x207c)    CTM_StartJob - Starting CTM job &#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;  </span><br><span class="line">04-12-2022 20:32:57.986    ContentTransferManager    8316 (0x207c)    Created CTM job &#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125; for user S-1-5-18  </span><br><span class="line">04-12-2022 20:32:58.001    ContentTransferManager    1936 (0x790)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_WAITING_CONTENTLOCATIONS  </span><br><span class="line">04-12-2022 20:32:58.001    ContentTransferManager    1936 (0x790)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): Queued location request LSRequest(&#x27;&#123;028DE696-C020-4CF7-8B55-F478FC3EF3BE&#125;&#x27;).  </span><br></pre></td></tr></table></figure><p>コンテンツの展開を受け取ったクライアントは、クライアントがコンテンツを取得する先のピアキャッシュ ソース 及び 配布ポイントをリストアップするためのリクエストを管理ポイントへ行います。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:58.220    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::_PersistLocations - Persisted locations  </span><br><span class="line">(SUBNETPEER) https://&lt;ピアキャッシュ ソース 1 台目のFQDN&gt;:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br><span class="line">(SUBNETPEER) https://&lt;ピアキャッシュ ソース 2 台目のFQDN&gt;:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br><span class="line">(SUBNET) http://&lt;配布ポイント&gt;/SMS_DP_SMSPKG$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br><span class="line">(SUBNET) https://&lt;配布ポイント&gt;/CCMTOKENAUTH_SMS_DP_SMSPKG$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br></pre></td></tr></table></figure><p>ピアキャッシュ ソース 及び 配布ポイントが一覧でリストアップされます。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:58.439    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::_DownloadContent - Created corresponding DTSJob(&#123;00CDF3E3-5C6A-4AFF-8F0E-8622CD538C8A&#125;)  </span><br><span class="line">04-12-2022 20:32:58.439    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::_DownloadContent - DTSJob(&#123;00CDF3E3-5C6A-4AFF-8F0E-8622CD538C8A&#125;) started to download from &#x27;https://FAB-W10Client2.fabrikam.com:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a&#x27; for full content download.  </span><br></pre></td></tr></table></figure><p>リスト内の一番上のピアキャッシュ ソースからコンテンツのダウンロードを開始します。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:58.455    ContentTransferManager    4188 (0x105c)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_MANIFEST  </span><br><span class="line">04-12-2022 20:32:58.502    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PROCESSING_MANIFEST  </span><br><span class="line">04-12-2022 20:32:58.517    ContentTransferManager    4384 (0x1120)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PREPARING_DOWNLOAD  </span><br><span class="line">04-12-2022 20:32:58.534    ContentTransferManager    4384 (0x1120)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_DATA  </span><br></pre></td></tr></table></figure><p>ダウンロードが進行中である事が記述されます。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:06.731    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): _ModifyDTSDownloadLocation - switched to location &#x27;https://&lt;ピアキャッシュ ソース 2 台目のFQDN&gt;:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a&#x27;  </span><br></pre></td></tr></table></figure><p>ネットワーク イシュー等が原因でリスト内の一番上のピアキャッシュ ソースからダウンロードが出来なかった為、リスト内の上から 2 番目のピアキャッシュ ソースからのダウンロードにスイッチ (変更) しました。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:06.731    ContentTransferManager    8592 (0x2190)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_MANIFEST  </span><br></pre></td></tr></table></figure><p>ダウンロードが進行中である事が記述されます。 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:27.828    ContentTransferManager    5524 (0x1594)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): _ModifyDTSDownloadLocation - switched to location &#x27;http://&lt;配布ポイント&gt;/SMS_DP_SMSPKG$/5d595a40-5699-4775-99a7-5f28b083750a&#x27;  </span><br></pre></td></tr></table></figure><p>こちらもネットワーク イシュー等が原因でダウンロードが出来ず、リスト内の上から 3 番目の配布ポイントからのダウンロードにスイッチ (変更) しました。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:27.828    ContentTransferManager    5900 (0x170c)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_MANIFEST  </span><br></pre></td></tr></table></figure><p>ダウンロードが進行中である事が記述されます。 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:28.054    ContentTransferManager    5900 (0x170c)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PROCESSING_MANIFEST  </span><br><span class="line">04-12-2022 20:35:28.069    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PREPARING_DOWNLOAD  </span><br><span class="line">04-12-2022 20:35:28.085    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_DATA  </span><br><span class="line">04-12-2022 20:35:32.879    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessDownloadSuccess - successfully processed download completion.  </span><br></pre></td></tr></table></figure><p>最終的に配布ポイントからコンテンツのダウンロードが完了しました。  </p><hr><p>上記のようにピアキャッシュの動作は ContentTransferManager.log に記述される為、もし「ピアキャッシュを有効にしたが、きちんと動作しているか心配」というご状況でございましたら、上記のログの流れがご参考になりましたら幸いです。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チーム青木です。  &lt;/p&gt;
&lt;p&gt;MECM からのコンテンツの配布の際に、ネットワークの負荷を軽減できるピアキャッシュ機能は実際にどのような動作となっているのか、ログの抜粋と共にご紹介させていただ</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>WSUS の仕組み レポート編</title>
    <link href="https://jpmem.github.io/blog/wsus/2022-07-07_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2022-07-07_01/</id>
    <published>2022-07-06T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.637Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。WSUS サポート チームです。</p><p>今回は、WSUSのレポートの仕組みについて、ご紹介していきたいと思います。<br>WSUS ではクライアントから状態レポートが報告され、それをもとにクライアントの更新プログラムの適用状況などを把握することができますが、<br>その仕組みの理解やレポートが報告されていないときなどのトラブルシューティングの際に、お役立ていただける情報となっていますので是非ご一読ください！  </p><h1 id="WSUS-の仕組み"><a href="#WSUS-の仕組み" class="headerlink" title="WSUS の仕組み"></a>WSUS の仕組み</h1><p>WSUS にクライアントからレポートが送られるときの流れは以下の通りです。    </p><ol><li>クライアントが次の処理を実施（更新プログラムの検出、ダウンロード、インストール）  </li><li>その結果をもとに状態レポートが WSUS へ送信される  </li><li>WSUSが状態レポートを受け取る  </li></ol><p>解説  </p><ol><li>クライアントが次の処理を実施（更新プログラムの検出、ダウンロード、インストール）<br>各処理の流れは以下の通りです。</li></ol><p>ⅰ. 更新プログラムの検出処理開始<br>ⅱ. 更新プログラムの検出処理完了 ＞ 2 を実施<br>ⅲ．ダウンロード処理開始<br>ⅳ．ダウンロード処理完了 ＞ 2 を実施<br>ⅴ．インストール処理開始<br>ⅵ．インストール処理完了 ＞ 2 を実施  </p><ol start="2"><li><p>1.の結果をもとに状態レポートがクライアントからWSUSへ送信<br>以下のフォルダにイベントを含むファイルが生成されます。<br>作成されたファイルは、IISの ReportingWebService を介してWSUSデータベースへ送信されます。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%windir%\SoftwareDistribution\EventCache.v2</span><br></pre></td></tr></table></figure></li><li><p>WSUS が状態レポートを受け取る<br>送信されたイベントファイルが WSUS データベースへ格納され、状態レポートとして WSUS で表示されます。  </p></li></ol><p>状態レポートの見方については以下の記事をご参照ください。<br><a href="https://jpmem.github.io/blog/wsus/2017-09-04_02/">WSUS のレポートに表示される「状態」の項目の説明</a></p><h1 id="トラブルシュート方法"><a href="#トラブルシュート方法" class="headerlink" title="トラブルシュート方法"></a>トラブルシュート方法</h1><p>状態レポートが WSUS にあがらないときに、まずご実施いただきたいトラブルシュート方法についてご紹介します。<br>以下の手順に沿って、検出処理実行からイベントファイル作成及び送信の動作をご確認ください。</p><p>1-1.[設定]&gt;[WindowsUpdate]&gt;[更新プログラムのチェック]を実行し検出を完了させます。<br>1-2.下記フォルダにイベントファイルが作成されたことを確認します。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%windir%\SoftwareDistribution\EventCache.v2</span><br></pre></td></tr></table></figure><p>1-3.以下のコマンドを実行します。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wuauclt /reportnow</span><br></pre></td></tr></table></figure><p>1-4. 1-2 で作成されたファイルがフォルダから消えていることを確認します。  </p><h3 id="1-1-から-1-4-まで全てが確認できた場合"><a href="#1-1-から-1-4-まで全てが確認できた場合" class="headerlink" title="1-1 から 1-4 まで全てが確認できた場合"></a>1-1 から 1-4 まで全てが確認できた場合</h3><p>ここまでの処理が実行されているにもかかわらず、WSUS 側で状態レポートが更新されないなどの事象が発生している場合には、<br>WSUS データベースへの書き込み処理の失敗なども疑われます為 の WSUS 及びクライアントのファイル送信時のログなども併せて確認する必要があります。  </p><h3 id="1-4-にてイベントファイルが送信されず滞留してしまう場合"><a href="#1-4-にてイベントファイルが送信されず滞留してしまう場合" class="headerlink" title="1-4 にてイベントファイルが送信されず滞留してしまう場合"></a>1-4 にてイベントファイルが送信されず滞留してしまう場合</h3><p>Windows Update のクライアント情報のキャッシュをクリアすることで解消されることがありますので、以下の記事に記載の手順をご実施ください。<br><a href="https://social.msdn.microsoft.com/Forums/ja-JP/8cec0049-4b41-4976-a440-d4012c8510ca/windows-update?forum=jpsccmwsus">Windows Update クライアントの情報をクリアにする手順</a>  </p><h3 id="補足：状態レポート報告完了の確認方法"><a href="#補足：状態レポート報告完了の確認方法" class="headerlink" title="補足：状態レポート報告完了の確認方法"></a>補足：状態レポート報告完了の確認方法</h3><p>WSUS コンソールより対象端末の最後の状態レポートの日時列の情報を参照してください。<br>WSUS コンソールを開き、 [コンピュータ] &gt; 確認対象のコンピュータを選択<br><img src="/blog/wsus/2022-07-07_01/2022-07-07_01_1.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。WSUS サポート チームです。&lt;/p&gt;
&lt;p&gt;今回は、WSUSのレポートの仕組みについて、ご紹介していきたいと思います。&lt;br&gt;WSUS ではクライアントから状態レポートが報告され、それをもとにクライアントの更新プログラムの適用状況などを把握すること</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
  </entry>
  
  <entry>
    <title>MECM 自動展開規則 ~使い方シリーズ~</title>
    <link href="https://jpmem.github.io/blog/mecm/20220706_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220706_01/</id>
    <published>2022-07-05T15:00:00.000Z</published>
    <updated>2023-03-02T03:37:32.477Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>使い方シリーズ、今回は自動展開規則の設定方法をステップバイステップで解説致します。<br>設定方法がよくわからない方、今の設定を見直したい方はぜひ確認してみてください。  </p><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><p>自動展開規則を作成する前に、必要となる準備を行います。  </p><p>1.自動展開規則を展開するデバイス コレクションを作成します。<br>2.自動展開規則で使用する展開パッケージを新規に作成する場合には、事前に共有フォルダーを作成しておく必要がございます。任意のパスにフォルダーを作成の上、共有設定を行ってください。</p><h2 id="自動展開規則の作成手順"><a href="#自動展開規則の作成手順" class="headerlink" title="自動展開規則の作成手順"></a>自動展開規則の作成手順</h2><p>1.MECM 管理コンソールを開き [ソフトウェア ライブラリ] &gt; [概要] &gt; [ソフトウェア更新プログラム] &gt; [自動展開規則] の順に開き、リボン上の [自動展開規則の作成] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_01.png" alt="image.png"></p><p>2.自動展開規則の作成ウィザードが開きますので、「全般」にて下記の設定を行います。  </p><ul><li><strong>名前</strong>　→　任意の名前を入力ください。  </li><li><strong>コレクション</strong>　→　自動展開規則を展開するデバイス コレクションを指定ください。  </li><li><strong>ソフトウェア更新プログラム グループ</strong>　→　<br>こちらについてはいずれを選んで頂いても問題ございませんが、[新しいソフトウェア更新プログラム グループを作成する] を選択した場合には、自動展開規則から更新プログラムが展開されるたびに新しいソフトウェア更新プログラム グループが追加作成されるため、グループが多数存在する状況となります。<br>そのため、特にこだわりがない場合には [既存のソフトウェア更新プログラム グループ] を選択くださいませ。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_02.png" alt="image.png"></p><p>3.「展開設定」にて、「展開の種類」を設定します。  </p><ul><li><strong>[必須] を指定した場合</strong><br>　→　ユーザー操作なしで自動的にインストールされます。  </li><li><strong>[利用可能] を指定した場合</strong><br>　→　ユーザーがクライアント端末側でソフトウェア センターを開き、[インストール] ボタンをクリックすることでインストールが開始されます。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_03.png" alt="image.png"></p><p>4.「ソフトウェア更新プログラム」にて、展開を行いたい更新プログラムのみが対象となるような「検索条件」を設定します。<br>この設定は非常に重要です。この検索条件が誤っていると意図していない更新プログラムが展開されてしまう可能性がございますので正しく設定しましょう。<br>検索条件でよく利用する代表的な項目に関しまして、<a href="###%E4%BB%A3%E8%A1%A8%E7%9A%84%E3%81%AA%E6%A4%9C%E7%B4%A2%E6%9D%A1%E4%BB%B6">代表的な検索条件</a> にて解説しておりますのでご確認くださいませ。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_09.png" alt="image.png"></p><p>5.「評価スケジュール」にて、任意の項目を選択の上、[次へ] をクリックします。  </p><ul><li><strong>[この規則を自動的に実行しない]</strong><br>　→　自動的に実行されないため手動での実行が必要となります。  </li><li><strong>[ソフトウェア更新ポイントが 1 つでも同期されたら、規則を実行する]</strong><br>　→　上部に表示されている [現在のソフトウェアの更新ポイントの同期スケジュール] のサイクルに沿って自動展開規則が実行されます。  </li><li><strong>[スケジュールに基づいて規則を実行する]</strong><br>　→　任意のスケジュールの設定が可能となります。  </li></ul><p>ソフトウェア更新ポイントの同期タイミングと自動展開規則の評価タイミングをずらしたいなど、特別なご事情が無い限りは [ソフトウェア更新ポイントが 1 つでも同期されたら、規則を実行する] を選択いただくことが一般的です。</p><p><img src="/blog/mecm/20220706_01/20220706_01_12.png" alt="image.png"></p><p>6.「展開スケジュール」にて、任意の項目を選択の上、[次へ] をクリックします。  </p><ul><li><strong>「基準」</strong><br>この展開のスケジュールを UTC、クライアントのローカル時刻のどちらを基準に評価するかを設定します。  </li></ul><p><strong>もしサーバーとタイムゾーンが異なるクライアントを管理する場合には「UTC」を選択頂く必要がございます。</strong><br>クライアントのタイムゾーンがすべて日本の場合には [クライアントのローカル時刻] を指定頂いても問題ございません。  </p><ul><li><strong>「ソフトウェアが使用可能な時間」および「インストールの期限」</strong><br>上記 2 つの設定によりクライアント側でインストールがスケジュールされる日時が決定します。<br>「ソフトウェアが使用可能な時間 ~ インストールの期限」の間でダウンロードがスケジュールされ、インストールの期限後にインストールが行われますので、すぐに適用させる場合にはいずれも [直ちに] を指定くださいませ。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_13.png" alt="image.png"></p><p>7.「ユーザー側の表示と操作」、「アラート」にて任意の設定を行い、[次へ] をクリックします。<br>8.「展開パッケージ」にて、既存の展開パッケージを使用する場合には [展開パッケージを選択する]、新しい展開パッケージを作成する場合には [新しい展開パッケージを使用する] を選択の上、「事前準備」で作成した共有フォルダーを [パッケージのソース] に指定し、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_14.png" alt="image.png"></p><p>※ 下記手順 9 におきましては新たに展開パッケージを作成する際の解説となります。  </p><p>9.「配布ポイント」にてこの自動展開規則にて展開する更新プログラムのコンテンツを配置する配布ポイントを指定し、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_15.png" alt="image.png"></p><p>10.「ダウンロード場所」にて [インターネットからソフトウェア更新プログラムをダウンロードする] を選択の上、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_16.png" alt="image.png"></p><p>11.「言語の選択」にて言語を選択の上、[次へ] をクリックします。<br>12.「ダウンロードの設定」にて、任意の設定を行い、[次へ] をクリックします。  </p><ul><li><strong>[クライアントが近隣の境界グループまたは既定サイトの境界グループから配布ポイントを使用する時に適用する配置オプションを選択します。]</strong><br>近隣の境界グループ（フォールバック設定された境界グループ）または Default-Site-Boudary-Group （既定サイトの境界グループ）に紐づく配布ポイントを使用する場合の挙動を設定します。  </li></ul></br><ul><li><strong>[現在または近隣の境界グループのどの配布ポイントでもソフトウェア更新プログラムを利用できない場合、クライアントは、サイト既定の境界グループ内の配布ポイントからソフトウェアの更新をダウンロードして、インストールできます。]</strong><br>現在または近隣の境界グループの配布ポイントを参照できない場合に、 Default-Site-Boudary-Group （既定サイトの境界グループ）を参照させるかどうかの挙動を設定します。  </li></ul></br><ul><li><p><strong>[関連する任意の境界グループ内の配布ポイントでソフトウェア更新プログラムを利用できない場合は…]</strong><br>配布ポイントからのダウンロードができなかった場合に、インターネット上の Microsoft Update から更新プログラムをダウンロードさせたい場合には、チェックを入れてください。  </p></li><li><p><strong>[インストールの期限後、クライアントが従量制のインターネット接続を使用してコンテンツをダウンロードできるようにする]</strong><br>これはインストール期限を迎えた場合には、クライアントが従量制課金のネットワークを使用している場合でもコンテンツのダウンロードを許可するかの設定となります。  </p></li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_17.png" alt="image.png"></p><p>13.「概要」にて、これまでに設定した内容に誤りが無いか確認の上、[次へ] をクリックします。<br>14.「完了」にて、「正常に完了しました」と表示されることを確認し [閉じる] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_18.png" alt="image.png"></p><p>以上で自動展開規則の設定は完了となります。<br>設定後、下記の通り「最後のエラーの説明」=「成功」となることをご確認くださいませ。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_19.png" alt="image.png"></p><h3 id="代表的な検索条件"><a href="#代表的な検索条件" class="headerlink" title="代表的な検索条件"></a>代表的な検索条件</h3><p>設定方法は様々ありますので、代表的なもののみ解説させて頂きます。  </p><ul><li><strong>[置き換え済み]</strong><br>この設定は非常に重要です。この条件を設定することにより更新プログラムの置き換え状態を条件にすることができます。<br>累積的な更新プログラムは新しい更新プログラムがリリースされると古いものを置き換えます。<br>置き換えられた更新プログラムの内容は新しい更新プログラム内に内包されるため、古い更新プログラムを配信する必要がありません。<br>そのため [置き換え済み] = [いいえ] の更新プログラム（つまり置き換えられていない最新の更新プログラム）のみを展開対象とすることで無駄な更新プログラムの展開を行わずにすむ為、必須となる条件となります。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_07.png" alt="image.png"></p><ul><li><strong>[更新プログラムの分類] および [製品]</strong><br>各更新プログラムごとに、適用対象となる [更新プログラムの分類] および [製品] が決まっております。<br>そのため、この 2 つを条件に追加することで分類と製品によるフィルターをかけることが可能となります。</br>  </li></ul><p><strong>確認方法</strong><br>1.MECM 管理コンソール &gt; [ソフトウェア ライブラリ] &gt; [概要] &gt; [ソフトウェア更新プログラム] &gt; [すべてのソフトウェア更新プログラム] にて、項目名バーを右クリックし、[更新プログラムの分類] および [製品] にチェックを入れます。<br>2.配信対象の更新プログラムの [更新プログラムの分類] および [製品] をご確認ください。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_04.png" alt="image.png"></p><ul><li><strong>[リリース日または変更日]</strong><br>特定の期間内にリリースまたは変更された更新プログラムを配信対象とすることができます。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_05.png" alt="image.png"></p><ul><li><strong>[必須]</strong><br>ソフトウェア更新プログラムの必須カウントを条件にすることができます。<br>これを設定することにより、必須と判定された更新プログラムのみを配信対象とすることができます。<br>下記では「&gt;=1」と設定することにより、必須カウントが 1 以上の場合には対象とする条件となります。</br><br>なお、必須カウントはクライアント端末側で定期的に実行される「ソフトウェア更新プログラムのスキャン サイクル」により、端末それぞれで必要な更新プログラムを必須と判断しカウントされていきます。<br>そのため、新しく同期されたばかりのソフトウェア更新プログラムはすぐには必須判定されず、クライアント側のスキャン サイクル実行後にカウントされる流れとなります。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_06.png" alt="image.png"></p><ul><li><strong>[タイトル]</strong><br>指定した文字列に部分一致するタイトルの更新プログラムを配信対象とすることができます。<br>例えば下記の「Beta」を指定する場合には、「Microsoft Edge-ARM64 ベース エディションの Beta チャネル バージョン」という更新プログラムが該当します。<br>なお、タイトルにおきましては、文字列の検索となるため、入力ミスなどで意図していない条件となってしまう可能性があります。<br>そのためその他の条件だけでは希望する更新プログラムを絞りきれない時にご活用くださいませ。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_08.png" alt="image.png"></p><h3 id="検索条件が正しいかの確認方法"><a href="#検索条件が正しいかの確認方法" class="headerlink" title="検索条件が正しいかの確認方法"></a>検索条件が正しいかの確認方法</h3><p>検索条件を設定し終わりましたら、[プレビュー] を表示してみましょう。<br>すると設定した検索条件に合致する更新プログラムの一覧を確認することができます。<br>ここで意図していない更新プログラムが表示されている場合には条件が不足している、誤っていることが想定されるので、意図した更新プログラムのみが表示されるまで検索条件を見直しましょう。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_10.png" alt="image.png"></p><p><img src="/blog/mecm/20220706_01/20220706_01_11.png" alt="image.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;使い方シリーズ、今回は自動展開規則の設定方法をステップバイステップで解説致します。&lt;br&gt;設定方法がよくわからない方、今の設定を見直したい方はぜひ確認してみてください</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
    <category term="使い方" scheme="https://jpmem.github.io/blog/tags/%E4%BD%BF%E3%81%84%E6%96%B9/"/>
    
  </entry>
  
</feed>
